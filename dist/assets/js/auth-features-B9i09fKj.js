const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/activity-features-BeCPKsHJ.js","assets/js/router-DIp0qzM7.js","assets/js/react-core-DJd1KkWy.js","assets/js/utils-C8L9ZeeV.js","assets/js/notifications-DK5Y3Ipx.js","assets/js/storage-BRXjPTYW.js","assets/js/state-Dl9MXZu6.js","assets/styles/activity-features-CMH0Kke3.css"])))=>i.map(i=>d[i]);
import{u as e,a as t,b as s,r as a,s as r,c as n,d as i,e as l,f as o,g as c}from"./utils-C8L9ZeeV.js";import{R as d,r as u,u as m,a as h,O as p}from"./router-DIp0qzM7.js";import"./activity-features-BeCPKsHJ.js";import{r as g,g as x}from"./react-core-DJd1KkWy.js";import{c as f,u as y}from"./state-Dl9MXZu6.js";import{r as v}from"./datetime-C5xEksKA.js";import{a as b}from"./http-client-CnGGTTUv.js";var j,N,w={exports:{}},k={},_=(N||(N=1,w.exports=function(){if(j)return k;j=1;var e=g(),t=Symbol.for("react.element"),s=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,r=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,n={key:!0,ref:!0,__self:!0,__source:!0};function i(e,s,i){var l,o={},c=null,d=null;for(l in void 0!==i&&(c=""+i),void 0!==s.key&&(c=""+s.key),void 0!==s.ref&&(d=s.ref),s)a.call(s,l)&&!n.hasOwnProperty(l)&&(o[l]=s[l]);if(e&&e.defaultProps)for(l in s=e.defaultProps)void 0===o[l]&&(o[l]=s[l]);return{$$typeof:t,type:e,key:c,ref:d,props:o,_owner:r.current}}return k.Fragment=s,k.jsx=i,k.jsxs=i,k}()),w.exports);const A={},S=function(e,t,s){let a=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map((e=>Promise.resolve(e).then((e=>({status:"fulfilled",value:e})),(e=>({status:"rejected",reason:e}))))))};document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),r=s?.nonce||s?.getAttribute("nonce");a=e(t.map((e=>{if((e=function(e){return"/"+e}(e))in A)return;A[e]=!0;const t=e.endsWith(".css"),s=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${s}`))return;const a=document.createElement("link");return a.rel=t?"stylesheet":"modulepreload",t||(a.as="script"),a.crossOrigin="",a.href=e,r&&a.setAttribute("nonce",r),document.head.appendChild(a),t?new Promise(((t,s)=>{a.addEventListener("load",t),a.addEventListener("error",(()=>s(new Error(`Unable to preload CSS for ${e}`))))})):void 0})))}function r(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return a.then((t=>{for(const e of t||[])"rejected"===e.status&&r(e.reason);return e().catch(r)}))},{useDebugValue:C}=d,{useSyncExternalStoreWithSelector:E}=y,L=e=>e,O={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},T=new Map,$=e=>{const t=T.get(e);return t?Object.fromEntries(Object.entries(t.stores).map((([e,t])=>[e,t.getState()]))):{}},D=(e,t={})=>(s,a,r)=>{const{enabled:n,anonymousActionType:i,store:l,...o}=t;let c;try{c=(null!=n?n:"production"!==(O?"production":void 0))&&window.__REDUX_DEVTOOLS_EXTENSION__}catch(g){}if(!c)return e(s,a,r);const{connection:d,...u}=((e,t,s)=>{if(void 0===e)return{type:"untracked",connection:t.connect(s)};const a=T.get(s.name);if(a)return{type:"tracked",store:e,...a};const r={connection:t.connect(s),stores:{}};return T.set(s.name,r),{type:"tracked",store:e,...r}})(l,c,o);let m=!0;r.setState=(e,t,n)=>{const c=s(e,t);if(!m)return c;const u=void 0===n?{type:i||"anonymous"}:"string"==typeof n?{type:n}:n;return void 0===l?(null==d||d.send(u,a()),c):(null==d||d.send({...u,type:`${l}/${u.type}`},{...$(o.name),[l]:r.getState()}),c)};const h=(...e)=>{const t=m;m=!1,s(...e),m=t},p=e(r.setState,a,r);if("untracked"===u.type?null==d||d.init(p):(u.stores[u.store]=r,null==d||d.init(Object.fromEntries(Object.entries(u.stores).map((([e,t])=>[e,e===u.store?p:t.getState()]))))),r.dispatchFromDevtools&&"function"==typeof r.dispatch){let e=!1;const t=r.dispatch;r.dispatch=(...s)=>{"production"===(O?"production":void 0)||"__setState"!==s[0].type||e||(e=!0),t(...s)}}return d.subscribe((e=>{var t;switch(e.type){case"ACTION":if("string"!=typeof e.payload)return;return M(e.payload,(e=>{if("__setState"!==e.type)r.dispatchFromDevtools&&"function"==typeof r.dispatch&&r.dispatch(e);else{if(void 0===l)return void h(e.state);Object.keys(e.state).length;const t=e.state[l];if(null==t)return;JSON.stringify(r.getState())!==JSON.stringify(t)&&h(t)}}));case"DISPATCH":switch(e.payload.type){case"RESET":return h(p),void 0===l?null==d?void 0:d.init(r.getState()):null==d?void 0:d.init($(o.name));case"COMMIT":return void 0===l?void(null==d||d.init(r.getState())):null==d?void 0:d.init($(o.name));case"ROLLBACK":return M(e.state,(e=>{if(void 0===l)return h(e),void(null==d||d.init(r.getState()));h(e[l]),null==d||d.init($(o.name))}));case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return M(e.state,(e=>{void 0!==l?JSON.stringify(r.getState())!==JSON.stringify(e[l])&&h(e[l]):h(e)}));case"IMPORT_STATE":{const{nextLiftedState:s}=e.payload,a=null==(t=s.computedStates.slice(-1)[0])?void 0:t.state;if(!a)return;return h(void 0===l?a:a[l]),void(null==d||d.send(null,s))}case"PAUSE_RECORDING":return m=!m}return}})),p},M=(e,t)=>{let s;try{s=JSON.parse(e)}catch($t){}void 0!==s&&t(s)};function P(e,t){let s;try{s=e()}catch(a){return}return{getItem:e=>{var t;const a=e=>null===e?null:JSON.parse(e,void 0),r=null!=(t=s.getItem(e))?t:null;return r instanceof Promise?r.then(a):a(r)},setItem:(e,t)=>s.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>s.removeItem(e)}}const I=e=>t=>{try{const s=e(t);return s instanceof Promise?s:{then:e=>I(e)(s),catch(e){return this}}}catch($t){return{then(e){return this},catch:t=>I(t)($t)}}},R=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((e,t)=>(s,a,r)=>{let n={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},i=!1;const l=new Set,o=new Set;let c;try{c=n.getStorage()}catch(x){}if(!c)return e(((...e)=>{s(...e)}),a,r);const d=I(n.serialize),u=()=>{const e=n.partialize({...a()});let t;const s=d({state:e,version:n.version}).then((e=>c.setItem(n.name,e))).catch((e=>{t=e}));if(t)throw t;return s},m=r.setState;r.setState=(e,t)=>{m(e,t),u()};const h=e(((...e)=>{s(...e),u()}),a,r);let p;const g=()=>{var e;if(!c)return;i=!1,l.forEach((e=>e(a())));const t=(null==(e=n.onRehydrateStorage)?void 0:e.call(n,a()))||void 0;return I(c.getItem.bind(c))(n.name).then((e=>{if(e)return n.deserialize(e)})).then((e=>{if(e){if("number"!=typeof e.version||e.version===n.version)return e.state;if(n.migrate)return n.migrate(e.state,e.version)}})).then((e=>{var t;return p=n.merge(e,null!=(t=a())?t:h),s(p,!0),u()})).then((()=>{null==t||t(p,void 0),i=!0,o.forEach((e=>e(p)))})).catch((e=>{null==t||t(void 0,e)}))};return r.persist={setOptions:e=>{n={...n,...e},e.getStorage&&(c=e.getStorage())},clearStorage:()=>{null==c||c.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>g(),hasHydrated:()=>i,onHydrate:e=>(l.add(e),()=>{l.delete(e)}),onFinishHydration:e=>(o.add(e),()=>{o.delete(e)})},g(),p||h})(e,t):((e,t)=>(s,a,r)=>{let n={storage:P((()=>localStorage)),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},i=!1;const l=new Set,o=new Set;let c=n.storage;if(!c)return e(((...e)=>{s(...e)}),a,r);const d=()=>{const e=n.partialize({...a()});return c.setItem(n.name,{state:e,version:n.version})},u=r.setState;r.setState=(e,t)=>{u(e,t),d()};const m=e(((...e)=>{s(...e),d()}),a,r);let h;r.getInitialState=()=>m;const p=()=>{var e,t;if(!c)return;i=!1,l.forEach((e=>{var t;return e(null!=(t=a())?t:m)}));const r=(null==(t=n.onRehydrateStorage)?void 0:t.call(n,null!=(e=a())?e:m))||void 0;return I(c.getItem.bind(c))(n.name).then((e=>{if(e){if("number"!=typeof e.version||e.version===n.version)return[!1,e.state];if(n.migrate)return[!0,n.migrate(e.state,e.version)]}return[!1,void 0]})).then((e=>{var t;const[r,i]=e;if(h=n.merge(i,null!=(t=a())?t:m),s(h,!0),r)return d()})).then((()=>{null==r||r(h,void 0),h=a(),i=!0,o.forEach((e=>e(h)))})).catch((e=>{null==r||r(void 0,e)}))};return r.persist={setOptions:e=>{n={...n,...e},e.storage&&(c=e.storage)},clearStorage:()=>{null==c||c.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>p(),hasHydrated:()=>i,onHydrate:e=>(l.add(e),()=>{l.delete(e)}),onFinishHydration:e=>(o.add(e),()=>{o.delete(e)})},n.skipHydration||p(),h||m})(e,t);var B=Symbol.for("immer-nothing"),U=Symbol.for("immer-draftable"),z=Symbol.for("immer-state");function F(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Y=Object.getPrototypeOf;function G(e){return!!e&&!!e[z]}function V(e){return!!e&&(W(e)||Array.isArray(e)||!!e[U]||!!e.constructor?.[U]||Q(e)||X(e))}var H=Object.prototype.constructor.toString();function W(e){if(!e||"object"!=typeof e)return!1;const t=Y(e);if(null===t)return!0;const s=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return s===Object||"function"==typeof s&&Function.toString.call(s)===H}function q(e,t){0===K(e)?Reflect.ownKeys(e).forEach((s=>{t(s,e[s],e)})):e.forEach(((s,a)=>t(a,s,e)))}function K(e){const t=e[z];return t?t.type_:Array.isArray(e)?1:Q(e)?2:X(e)?3:0}function J(e,t){return 2===K(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Z(e,t,s){const a=K(e);2===a?e.set(t,s):3===a?e.add(s):e[t]=s}function Q(e){return e instanceof Map}function X(e){return e instanceof Set}function ee(e){return e.copy_||e.base_}function te(e,t){if(Q(e))return new Map(e);if(X(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const s=W(e);if(!0===t||"class_only"===t&&!s){const t=Object.getOwnPropertyDescriptors(e);delete t[z];let s=Reflect.ownKeys(t);for(let a=0;a<s.length;a++){const r=s[a],n=t[r];!1===n.writable&&(n.writable=!0,n.configurable=!0),(n.get||n.set)&&(t[r]={configurable:!0,writable:!0,enumerable:n.enumerable,value:e[r]})}return Object.create(Y(e),t)}{const t=Y(e);if(null!==t&&s)return{...e};const a=Object.create(t);return Object.assign(a,e)}}function se(e,t=!1){return re(e)||G(e)||!V(e)||(K(e)>1&&(e.set=e.add=e.clear=e.delete=ae),Object.freeze(e),t&&Object.entries(e).forEach((([e,t])=>se(t,!0)))),e}function ae(){F(2)}function re(e){return Object.isFrozen(e)}var ne,ie={};function le(e){const t=ie[e];return t||F(0),t}function oe(){return ne}function ce(e,t){t&&(le("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function de(e){ue(e),e.drafts_.forEach(he),e.drafts_=null}function ue(e){e===ne&&(ne=e.parent_)}function me(e){return ne={drafts_:[],parent_:ne,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function he(e){const t=e[z];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function pe(e,t){t.unfinalizedDrafts_=t.drafts_.length;const s=t.drafts_[0];return void 0!==e&&e!==s?(s[z].modified_&&(de(t),F(4)),V(e)&&(e=ge(t,e),t.parent_||fe(t,e)),t.patches_&&le("Patches").generateReplacementPatches_(s[z].base_,e,t.patches_,t.inversePatches_)):e=ge(t,s,[]),de(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==B?e:void 0}function ge(e,t,s){if(re(t))return t;const a=t[z];if(!a)return q(t,((r,n)=>xe(e,a,t,r,n,s))),t;if(a.scope_!==e)return t;if(!a.modified_)return fe(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const t=a.copy_;let r=t,n=!1;3===a.type_&&(r=new Set(t),t.clear(),n=!0),q(r,((r,i)=>xe(e,a,t,r,i,s,n))),fe(e,t,!1),s&&e.patches_&&le("Patches").generatePatches_(a,s,e.patches_,e.inversePatches_)}return a.copy_}function xe(e,t,s,a,r,n,i){if(G(r)){const i=ge(e,r,n&&t&&3!==t.type_&&!J(t.assigned_,a)?n.concat(a):void 0);if(Z(s,a,i),!G(i))return;e.canAutoFreeze_=!1}else i&&s.add(r);if(V(r)&&!re(r)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;ge(e,r),t&&t.scope_.parent_||"symbol"==typeof a||!Object.prototype.propertyIsEnumerable.call(s,a)||fe(e,r)}}function fe(e,t,s=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&se(t,s)}var ye={get(e,t){if(t===z)return e;const s=ee(e);if(!J(s,t))return function(e,t,s){const a=je(t,s);return a?"value"in a?a.value:a.get?.call(e.draft_):void 0}(e,s,t);const a=s[t];return e.finalized_||!V(a)?a:a===be(e.base_,t)?(we(e),e.copy_[t]=ke(a,e)):a},has:(e,t)=>t in ee(e),ownKeys:e=>Reflect.ownKeys(ee(e)),set(e,t,s){const a=je(ee(e),t);if(a?.set)return a.set.call(e.draft_,s),!0;if(!e.modified_){const a=be(ee(e),t),i=a?.[z];if(i&&i.base_===s)return e.copy_[t]=s,e.assigned_[t]=!1,!0;if(((r=s)===(n=a)?0!==r||1/r==1/n:r!=r&&n!=n)&&(void 0!==s||J(e.base_,t)))return!0;we(e),Ne(e)}var r,n;return e.copy_[t]===s&&(void 0!==s||t in e.copy_)||Number.isNaN(s)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=s,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==be(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,we(e),Ne(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const s=ee(e),a=Reflect.getOwnPropertyDescriptor(s,t);return a?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:a.enumerable,value:s[t]}:a},defineProperty(){F(11)},getPrototypeOf:e=>Y(e.base_),setPrototypeOf(){F(12)}},ve={};function be(e,t){const s=e[z];return(s?ee(s):e)[t]}function je(e,t){if(!(t in e))return;let s=Y(e);for(;s;){const e=Object.getOwnPropertyDescriptor(s,t);if(e)return e;s=Y(s)}}function Ne(e){e.modified_||(e.modified_=!0,e.parent_&&Ne(e.parent_))}function we(e){e.copy_||(e.copy_=te(e.base_,e.scope_.immer_.useStrictShallowCopy_))}function ke(e,t){const s=Q(e)?le("MapSet").proxyMap_(e,t):X(e)?le("MapSet").proxySet_(e,t):function(e,t){const s=Array.isArray(e),a={type_:s?1:0,scope_:t?t.scope_:oe(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=a,n=ye;s&&(r=[a],n=ve);const{revoke:i,proxy:l}=Proxy.revocable(r,n);return a.draft_=l,a.revoke_=i,l}(e,t);return(t?t.scope_:oe()).drafts_.push(s),s}function _e(e){if(!V(e)||re(e))return e;const t=e[z];let s;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,s=te(e,t.scope_.immer_.useStrictShallowCopy_)}else s=te(e,!0);return q(s,((e,t)=>{Z(s,e,_e(t))})),t&&(t.finalized_=!1),s}q(ye,((e,t)=>{ve[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),ve.deleteProperty=function(e,t){return ve.set.call(this,e,t,void 0)},ve.set=function(e,t,s){return ye.set.call(this,e[0],t,s,e[0])};var Ae=new class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,s)=>{if("function"==typeof e&&"function"!=typeof t){const s=t;t=e;const a=this;return function(e=s,...r){return a.produce(e,(e=>t.call(this,e,...r)))}}let a;if("function"!=typeof t&&F(6),void 0!==s&&"function"!=typeof s&&F(7),V(e)){const r=me(this),n=ke(e,void 0);let i=!0;try{a=t(n),i=!1}finally{i?de(r):ue(r)}return ce(r,s),pe(a,r)}if(!e||"object"!=typeof e){if(a=t(e),void 0===a&&(a=e),a===B&&(a=void 0),this.autoFreeze_&&se(a,!0),s){const t=[],r=[];le("Patches").generateReplacementPatches_(e,a,t,r),s(t,r)}return a}F(1)},this.produceWithPatches=(e,t)=>{if("function"==typeof e)return(t,...s)=>this.produceWithPatches(t,(t=>e(t,...s)));let s,a;return[this.produce(e,t,((e,t)=>{s=e,a=t})),s,a]},"boolean"==typeof e?.autoFreeze&&this.setAutoFreeze(e.autoFreeze),"boolean"==typeof e?.useStrictShallowCopy&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){var t;V(e)||F(8),G(e)&&(G(t=e)||F(10),e=_e(t));const s=me(this),a=ke(e,void 0);return a[z].isManual_=!0,ue(s),a}finishDraft(e,t){const s=e&&e[z];s&&s.isManual_||F(9);const{scope_:a}=s;return ce(a,t),pe(void 0,a)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let s;for(s=t.length-1;s>=0;s--){const a=t[s];if(0===a.path.length&&"replace"===a.op){e=a.value;break}}s>-1&&(t=t.slice(s+1));const a=le("Patches").applyPatches_;return G(e)?a(e,t):this.produce(e,(e=>a(e,t)))}},Se=Ae.produce;Ae.produceWithPatches.bind(Ae),Ae.setAutoFreeze.bind(Ae),Ae.setUseStrictShallowCopy.bind(Ae),Ae.applyPatches.bind(Ae),Ae.createDraft.bind(Ae),Ae.finishDraft.bind(Ae);var Ce=(e=>(e.MEET_AT_ENTRANCE="MEET_AT_ENTRANCE",e.FIRST_COME_FIRST_CLIMB="FIRST_COME_FIRST_CLIMB",e))(Ce||{}),Ee=(e=>(e.OPEN="OPEN",e.FULL="FULL",e.ONGOING="ONGOING",e.COMPLETED="COMPLETED",e.CANCELLED="CANCELLED",e))(Ee||{}),Le=(e=>(e.FREE="FREE",e.AA="AA",e.HOST_TREAT="HOST_TREAT",e))(Le||{}),Oe=(e=>(e.BOULDERING="BOULDERING",e.TOP_ROPE_AUTO_BELAY="TOP_ROPE_AUTO_BELAY",e.TOP_ROPE_MANUAL_BELAY="TOP_ROPE_MANUAL_BELAY",e.LEAD_CLIMBING="LEAD_CLIMBING",e.OUTDOOR="OUTDOOR",e.TRAINING="TRAINING",e))(Oe||{}),Te=(e=>(e.V0_V2="V0-V2",e.V3_V5="V3-V5",e.V6_V7="V6-V7",e.V8_PLUS="V8+",e.V_OPEN="V_OPEN",e.YDS_5_5_5_8="YDS_5.5-5.8",e.YDS_5_9_5_10D="YDS_5.9-5.10d",e.YDS_5_11A_5_11D="YDS_5.11a-5.11d",e.YDS_5_12A_5_12D="YDS_5.12a-5.12d",e.YDS_5_13_PLUS="YDS_5.13+",e.YDS_OPEN="YDS_OPEN",e))(Te||{}),$e=(e=>(e.SHOES="SHOES",e.HARNESS="HARNESS",e.ROPE="ROPE",e.QUICKDRAWS="QUICKDRAWS",e.CHALK="CHALK",e.BELAY_DEVICE="BELAY_DEVICE",e.HELMET="HELMET",e))($e||{});const De={receiveNewCommentNotifications:!0,receiveActivityJoinNotifications:!0,receiveActivityUpdateNotifications:!0,receiveSystemAnnouncements:!0},Me=x(v()),Pe="climberdaz_preferences",Ie="服务器错误，请稍后重试",Re=2,Be=20,Ue=[{openid:"user1",nickname:"RockClimber",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=RockClimber",level:5,gearTags:[$e.SHOES,$e.HARNESS,$e.CHALK],createdAt:new Date("2024-01-15"),climbingAge:3,introduction:"热爱攀岩的程序员，喜欢挑战V6-V8的线路",city:"北京",frequentlyVisitedGyms:["岩时攀岩馆（望京店）","MWA攀岩馆"],climbingPreferences:[Oe.BOULDERING,Oe.LEAD_CLIMBING],notificationPreferences:De,role:"user",isBanned:!1},{openid:"user2",nickname:"NewbieClimber",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=NewbieClimber",level:2,gearTags:[$e.SHOES],createdAt:new Date("2024-03-10"),climbingAge:1,introduction:"攀岩新手，希望能找到一起学习的朋友",city:"上海",frequentlyVisitedGyms:["峭壁芭蕾攀岩馆"],climbingPreferences:[Oe.BOULDERING,Oe.TRAINING],notificationPreferences:De,role:"user",isBanned:!1},{openid:"user3",nickname:"AdminUser",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=AdminUser",level:8,gearTags:[$e.SHOES,$e.HARNESS,$e.ROPE,$e.QUICKDRAWS,$e.BELAY_DEVICE],createdAt:new Date("2023-12-01"),climbingAge:5,introduction:"平台管理员，资深攀岩爱好者",city:"深圳",frequentlyVisitedGyms:["KAILAS攀岩馆"],climbingPreferences:[Oe.BOULDERING,Oe.LEAD_CLIMBING,Oe.OUTDOOR],notificationPreferences:De,role:"admin",isBanned:!1},{openid:"user4",nickname:"BannedUserExample",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=BannedUserExample",level:1,gearTags:[],createdAt:new Date("2024-04-01"),climbingAge:0,city:"广州",notificationPreferences:De,role:"user",isBanned:!0}],ze=[{id:"1",hostId:"user1",title:"周末一起攀岩吧！V4-V6 level",datetime:new Date("2025-06-01T14:00:00"),locationText:"岩时攀岩馆（望京店）",lat:39.9884,lng:116.4716,meetMode:Ce.MEET_AT_ENTRANCE,isPrivate:!1,types:[Oe.BOULDERING],grades:[Te.V3_V5,Te.V6_V7],costMode:Le.AA,slotMax:4,status:Ee.OPEN,createdAt:new Date("2024-05-15"),participantIds:["user1","user2"],participantCount:2,host:Ue[0],distance:2.5},{id:"2",hostId:"user2",title:"新手友好局，一起学习抱石",datetime:new Date("2025-06-02T10:00:00"),locationText:"MWA攀岩馆",lat:39.9304,lng:116.4316,meetMode:Ce.FIRST_COME_FIRST_CLIMB,isPrivate:!1,types:[Oe.BOULDERING,Oe.TRAINING],grades:[Te.V0_V2],costMode:Le.FREE,slotMax:6,status:Ee.OPEN,createdAt:new Date("2024-05-16"),participantIds:["user2","user3","user1"],participantCount:3,host:Ue[1],distance:5.2},{id:"3",hostId:"user3",title:"先锋攀登技术分享",datetime:new Date("2025-06-03T19:00:00"),locationText:"KAILAS攀岩馆",lat:40.0084,lng:116.4816,meetMode:Ce.MEET_AT_ENTRANCE,isPrivate:!1,types:[Oe.LEAD_CLIMBING,Oe.TRAINING],grades:[Te.YDS_5_9_5_10D,Te.YDS_5_11A_5_11D],costMode:Le.HOST_TREAT,slotMax:8,status:Ee.OPEN,createdAt:new Date("2024-05-17"),participantIds:["user3"],participantCount:1,host:Ue[2],distance:1.8},{id:"4",hostId:"user1",title:"户外攀岩 - 怀柔线路探索",datetime:new Date("2025-06-05T08:00:00"),locationText:"怀柔区攀岩场地",lat:40.3916,lng:116.631,meetMode:Ce.MEET_AT_ENTRANCE,isPrivate:!1,types:[Oe.OUTDOOR],grades:[Te.YDS_5_5_5_8,Te.YDS_5_9_5_10D],costMode:Le.AA,slotMax:4,status:Ee.FULL,createdAt:new Date("2024-05-18"),participantIds:["user1","user2","user3","user4"],participantCount:4,host:Ue[0],distance:45.3},{id:"5",hostId:"user2",title:"周中放松攀爬",datetime:new Date("2025-05-20T18:30:00"),locationText:"峭壁芭蕾攀岩馆",lat:31.2304,lng:121.4737,meetMode:Ce.FIRST_COME_FIRST_CLIMB,isPrivate:!1,types:[Oe.BOULDERING],grades:[Te.V0_V2,Te.V3_V5],costMode:Le.AA,slotMax:5,status:Ee.COMPLETED,createdAt:new Date("2024-05-10"),participantIds:["user2","user1"],participantCount:2,host:Ue[1],distance:8.7}],Fe=[{id:"1",title:"🎉 ClimberDaz 正式上线！欢迎各位岩友",content:"经过紧张的开发和测试，ClimberDaz攀岩找搭子平台正式上线啦！感谢大家的耐心等待。现在你可以轻松找到攀岩伙伴，创建活动，分享攀岩经验。让我们一起在这个平台上建立一个活跃的攀岩社区！",startAt:new Date("2024-05-01"),endAt:new Date("2025-12-31"),weight:10,createdAt:new Date("2024-05-01")},{id:"2",title:"📢 本周六有官方组织的新手教学活动",content:"为了帮助更多新朋友快速入门攀岩运动，我们将在本周六下午2点在岩时攀岩馆举办新手教学活动。活动包括：基础攀爬技巧、安全知识讲解、装备介绍等。活动免费，欢迎新手朋友参加！",startAt:new Date("2024-05-20"),endAt:new Date("2024-06-30"),weight:8,createdAt:new Date("2024-05-20")},{id:"3",title:"⚠️ 平台维护通知",content:"为了提供更好的服务，平台将在本周日凌晨2:00-4:00进行系统维护升级。维护期间可能无法正常访问，给您带来的不便敬请谅解。",startAt:new Date("2024-05-25"),endAt:new Date("2024-05-26"),weight:6,createdAt:new Date("2024-05-25")}],Ye={login:"/auth/login",register:"/auth/register",profile:"/auth/profile",logout:"/auth/logout"},Ge={base:"/activities",byId:e=>`/activities/${e}`,join:e=>`/activities/${e}/join`,leave:e=>`/activities/${e}/leave`,search:"/activities/search",my:"/activities/my"},Ve={base:"/climbing-gyms",byId:e=>`/climbing-gyms/${e}`,byCity:e=>`/climbing-gyms/city/${e}`,search:"/climbing-gyms/search"};var He=Object.defineProperty,We=(e,t,s)=>((e,t,s)=>t in e?He(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s);b.defaults.baseURL="http://localhost:3001/api",b.defaults.timeout=1e4;class qe extends Error{constructor(e,t=0,s,a,r){super(e),We(this,"status"),We(this,"code"),We(this,"details"),We(this,"config"),this.name="ApiError",this.status=t,this.details=s,this.config=a,this.code=r}}const Ke={getToken:()=>localStorage.getItem("climberdaz_token"),setToken:e=>localStorage.setItem("climberdaz_token",e),removeToken:()=>localStorage.removeItem("climberdaz_token"),isTokenValid:()=>{const e=Ke.getToken();if(!e)return!1;try{return 1e3*JSON.parse(atob(e.split(".")[1])).exp>Date.now()}catch{return!1}}},Je=e=>{const t=Ke.getToken();return{"Content-Type":"application/json",...t&&{Authorization:`Bearer ${t}`}}};b.interceptors.request.use((e=>{const t=Ke.getToken();return t&&Ke.isTokenValid()&&(e.headers.Authorization=`Bearer ${t}`),e}),(e=>Promise.reject(e))),b.interceptors.response.use((e=>e),(e=>(401===e.response?.status&&(Ke.removeToken(),window.location.href="/login"),Promise.reject(e))));const Ze=e=>{if(e instanceof qe)return e;if(b.isAxiosError(e)){const t=e.response?.status||0,s=e.response?.data?.message||e.message||Ie,a=e.response?.data?.details||{};return new qe(s,t,a,e.config)}return e instanceof Error?new qe(e.message||Ie,0):new qe(Ie,0)},Qe=async(e,t,s)=>{try{const a=((e,t)=>{if(!t||0===Object.keys(t).length)return e;const s=(e=>{const t=new URLSearchParams;return Object.entries(e).forEach((([e,s])=>{null!=s&&(Array.isArray(s)?s.forEach((s=>t.append(e,String(s)))):s instanceof Date?t.append(e,s.toISOString()):"object"==typeof s?t.append(e,JSON.stringify(s)):t.append(e,String(s)))})),t.toString()})(Object.fromEntries(Object.entries(t).filter((([e,t])=>null!=t&&""!==t))));return s?`${e}?${s}`:e})(e,t);return(await b.get(a,{...s,headers:{...Je(),...s?.headers}})).data}catch(a){throw Ze(a)}},Xe=async(e,t,s)=>{try{return(await b.post(e,t,{...s,headers:{...Je(),...s?.headers}})).data}catch(a){throw Ze(a)}},et=async(e,t,s)=>{try{return(await b.patch(e,t,{...s,headers:{...Je(),...s?.headers}})).data}catch(a){throw Ze(a)}},tt=async(e,t)=>{try{return(await b.delete(e,{...t,headers:{...Je(),...t?.headers}})).data}catch(s){throw Ze(s)}};class st{static async getAll(e){return await Qe(Ge.base,e)}static async getById(e){return await Qe(Ge.byId(e))}static async create(e){return await Xe(Ge.base,e)}static async update(e,t){return await et(Ge.byId(e),t)}static async delete(e){await tt(Ge.byId(e))}static async join(e){return await Xe(Ge.join(e))}static async leave(e){return await tt(Ge.leave(e))}static async search(e){return await Qe(Ge.search,e)}static async getMyActivities(e){return await Qe(Ge.my,e)}static async getByStatus(e,t){return await this.getAll({...t,status:e})}static async getOngoing(e){return await this.getByStatus(Ee.ONGOING,e)}static async getOpen(e){return await this.getByStatus(Ee.OPEN,e)}static async getOngoingActivities(e){return(await this.getOngoing(e)).activities}static async getOpenActivities(e){return(await this.getOpen(e)).activities}static async searchActivities(e){return(await this.search(e)).activities}static async getActivitiesByStatus(e,t){return(await this.getByStatus(e,t)).activities}}const at=[{openid:"user1",nickname:"RockClimber",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=RockClimber",gearTags:["SHOES"],createdAt:new Date,role:"user",isBanned:!1,climbingAge:3,city:"北京",frequentlyVisitedGyms:["岩时攀岩馆（望京店）"],climbingPreferences:["BOULDERING"],notificationPreferences:De},{openid:"user2",nickname:"NewbieClimber",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=NewbieClimber",gearTags:[],createdAt:new Date,role:"user",isBanned:!1,climbingAge:1,city:"上海",notificationPreferences:De},{openid:"user3",nickname:"AdminUser",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=AdminUser",gearTags:[],createdAt:new Date,role:"admin",isBanned:!1,notificationPreferences:De}],rt=((e,t)=>{const s=f(e),a=(e,a=t)=>function(e,t=L,s){const a=E(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,s);return C(a),a}(s,e,a);return Object.assign(a,s),a})(D(R((pt=(e,t)=>({user:null,allUsers:at,isAuthenticated:!1,isLoading:!1,activities:[],currentActivity:null,totalActivities:0,isLoadingActivities:!1,searchText:"",selectedTypes:[],selectedGrades:[],announcements:Fe,isLoadingAnnouncements:!1,error:null,theme:"light",setUser:t=>e((e=>{e.user=t?{...t,notificationPreferences:t.notificationPreferences||De}:null,e.isAuthenticated=!!t})),logout:()=>e((e=>{e.user=null,e.isAuthenticated=!1,e.activities=[],e.currentActivity=null,e.totalActivities=0,e.searchText="",e.selectedTypes=[],e.selectedGrades=[]})),setAllUsers:t=>e((e=>{e.allUsers=t.map((e=>({...e,notificationPreferences:e.notificationPreferences||De})))})),updateUserStatus:(t,s)=>e((e=>{const a=e.allUsers.findIndex((e=>e.openid===t));-1!==a&&Object.assign(e.allUsers[a],s),e.user?.openid===t&&Object.assign(e.user,s)})),updateUserProfile:t=>e((e=>{if(e.user){Object.assign(e.user,t);const s=e.allUsers.findIndex((t=>t.openid===e.user.openid));-1!==s&&Object.assign(e.allUsers[s],t)}})),updateUserNotificationPreferences:t=>e((e=>{e.user&&e.user.notificationPreferences&&Object.assign(e.user.notificationPreferences,t)})),setUserLoading:t=>e((e=>{e.isLoading=t})),setActivities:t=>e((e=>{e.activities=t,e.totalActivities=t.length})),setCurrentActivity:t=>e((e=>{e.currentActivity=t})),addActivity:t=>e((e=>{e.activities.some((e=>e.id===t.id))||(e.activities.unshift(t),e.totalActivities+=1)})),updateActivity:(t,s)=>e((e=>{const a=e.activities.findIndex((e=>e.id===t));-1!==a&&Object.assign(e.activities[a],s),e.currentActivity?.id===t&&Object.assign(e.currentActivity,s)})),removeActivity:t=>e((e=>{const s=e.activities.length;e.activities=e.activities.filter((e=>e.id!==t)),e.activities.length<s&&(e.totalActivities=Math.max(0,e.totalActivities-1)),e.currentActivity?.id===t&&(e.currentActivity=null)})),joinActivity:async e=>{const s=t();if(!s.user)throw new Error("User not authenticated");try{if(!(await fetch(`/api/activities/${e}/join`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.user.token}`}})).ok)throw new Error("Failed to join activity");await t().fetchActivities()}catch(a){throw a}},leaveActivity:async e=>{const s=t();if(!s.user)throw new Error("User not authenticated");try{if(!(await fetch(`/api/activities/${e}/leave`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.user.token}`}})).ok)throw new Error("Failed to leave activity");await t().fetchActivities()}catch(a){throw a}},setSearchText:t=>e((e=>{e.searchText=t})),setSelectedTypes:t=>e((e=>{e.selectedTypes=t})),setSelectedGrades:t=>e((e=>{e.selectedGrades=t})),resetFilters:()=>e((e=>{e.searchText="",e.selectedTypes=[],e.selectedGrades=[]})),setActivityLoading:t=>e((e=>{e.isLoadingActivities=t})),setAnnouncements:t=>e((e=>{e.announcements=t})),setError:t=>e((e=>{e.error=t})),toggleTheme:()=>e((e=>{e.theme="light"===e.theme?"dark":"light"})),setAnnouncementLoading:t=>e((e=>{e.isLoadingAnnouncements=t})),fetchActivities:async()=>{try{e((e=>{e.isLoadingActivities=!0}));try{const t=await st.getAll();e((e=>{e.activities=t.activities||[],e.totalActivities=t.total||t.activities?.length||0,e.isLoadingActivities=!1,e.error=null}))}catch(t){e((e=>{e.activities=ze,e.totalActivities=ze.length,e.isLoadingActivities=!1,e.error="Using mock data - API unavailable"}))}}catch(s){throw e((e=>{e.isLoadingActivities=!1,e.error=s instanceof Error?s.message:"Failed to fetch activities"})),s}},refreshActivities:async()=>{try{e((e=>{e.isLoadingActivities=!0}));try{const t=await st.getAll();e((e=>{e.activities=t.activities||[],e.totalActivities=t.total||t.activities?.length||0,e.isLoadingActivities=!1,e.error=null}))}catch(t){e((e=>{e.activities=ze,e.totalActivities=ze.length,e.isLoadingActivities=!1,e.error="Using mock data - API unavailable"}))}}catch(s){throw e((e=>{e.isLoadingActivities=!1,e.error=s instanceof Error?s.message:"Failed to refresh activities"})),s}}}),ht=(e,t,s)=>(s.setState=(t,s,...a)=>{const r="function"==typeof t?Se(t):t;return e(r,s,...a)},pt(s.setState,t,s)),(e,t,s)=>{const a=s.subscribe;return s.subscribe=(e,t,r)=>{let n=e;if(t){const a=(null==r?void 0:r.equalityFn)||Object.is;let i=e(s.getState());n=s=>{const r=e(s);if(!a(i,r)){const e=i;t(i=r,e)}},(null==r?void 0:r.fireImmediately)&&t(i,i)}return a(n)},ht(e,t,s)}),{name:Pe,partialize:e=>({user:e.user,isAuthenticated:e.isAuthenticated,theme:e.theme,searchText:e.searchText,selectedTypes:e.selectedTypes,selectedGrades:e.selectedGrades}),version:1,migrate:(e,t)=>0!==t&&t?e:{...e,theme:e.theme||"light",searchText:e.searchText||"",selectedTypes:Array.isArray(e.selectedTypes)?e.selectedTypes:[],selectedGrades:Array.isArray(e.selectedGrades)?e.selectedGrades:[],user:e.user?{...e.user,notificationPreferences:e.user.notificationPreferences||De}:null},onRehydrateStorage:()=>(e,t)=>{t&&localStorage.removeItem(Pe)}}),{name:"ClimberDaz Store",enabled:!1}),(function(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[s,a]of e)if(!Object.is(a,t.get(s)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const s of e)if(!t.has(s))return!1;return!0}const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!1;for(const a of s)if(!Object.prototype.hasOwnProperty.call(t,a)||!Object.is(e[a],t[a]))return!1;return!0})),nt=()=>rt((e=>({user:e.user,allUsers:e.allUsers,isAuthenticated:e.isAuthenticated,isLoading:e.isLoading}))),it=()=>rt((e=>({activities:e.activities,currentActivity:e.currentActivity,isLoadingActivities:e.isLoadingActivities,totalActivities:e.totalActivities}))),lt=()=>rt((e=>({searchText:e.searchText,selectedTypes:e.selectedTypes,selectedGrades:e.selectedGrades}))),ot=()=>rt((e=>({setUser:e.setUser,logout:e.logout,setAllUsers:e.setAllUsers,updateUserStatus:e.updateUserStatus,updateUserProfile:e.updateUserProfile,updateUserNotificationPreferences:e.updateUserNotificationPreferences,setUserLoading:e.setUserLoading}))),ct=()=>rt((e=>({setActivities:e.setActivities,setCurrentActivity:e.setCurrentActivity,addActivity:e.addActivity,updateActivity:e.updateActivity,removeActivity:e.removeActivity,joinActivity:e.joinActivity,leaveActivity:e.leaveActivity,setActivityLoading:e.setActivityLoading,fetchActivities:e.fetchActivities,refreshActivities:e.refreshActivities}))),dt=()=>rt((e=>({setSearchText:e.setSearchText,setSelectedTypes:e.setSelectedTypes,setSelectedGrades:e.setSelectedGrades,resetFilters:e.resetFilters}))),ut=()=>{const{notifications:t}=e();return t.length?_.jsx("div",{className:"notification-container fixed top-4 right-4 space-y-2 max-w-sm",style:{zIndex:1070},children:t.map(((e,t)=>_.jsx("div",{className:"notification-toast p-4 rounded-lg shadow-lg transform transition-all duration-300 ease-in-out "+("success"===e.type?"bg-green-500 text-white":"error"===e.type?"bg-red-500 text-white":"warning"===e.type?"bg-yellow-500 text-white":"bg-blue-500 text-white"),role:"alert","aria-live":"polite",children:_.jsxs("div",{className:"flex items-center",children:[_.jsxs("span",{className:"mr-2",children:["success"===e.type&&"✅","error"===e.type&&"❌","warning"===e.type&&"⚠️","info"===e.type&&"ℹ️"]}),_.jsx("span",{className:"flex-1",children:e.content})]})},t)))}):null},mt=({className:e="",minimal:a=!1,showDetails:r=!1})=>{const{isConnected:n}=t(),{syncStatus:i,forceSyncNow:l,getStorageInfo:o}=s(),[c,d]=u.useState(!1),[m,h]=u.useState({used:0,quota:0,percentage:0});u.useEffect((()=>{const e=async()=>{const e=await o();h(e)};e();const t=setInterval(e,6e4);return()=>clearInterval(t)}),[o]);const p=e=>{if(0===e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(1))+" "+["B","KB","MB","GB"][t]},g=i.isOnline?n?i.syncInProgress?{status:"syncing",label:"同步中",color:"bg-blue-500",icon:"⬆️",description:"正在同步数据"}:i.failedOperations>0?{status:"error",label:"同步失败",color:"bg-red-500",icon:"⚠️",description:`${i.failedOperations} 个操作同步失败`}:i.pendingOperations>0?{status:"pending",label:"待同步",color:"bg-orange-500",icon:"⏳",description:`${i.pendingOperations} 个操作待同步`}:{status:"online",label:"已连接",color:"bg-green-500",icon:"✅",description:"实时连接正常"}:{status:"connecting",label:"连接中",color:"bg-yellow-500",icon:"🔄",description:"正在连接服务器"}:{status:"offline",label:"离线模式",color:"bg-gray-500",icon:"📴",description:"网络未连接，使用本地数据"};return a?_.jsx("div",{className:`status-bar-minimal ${e}`,children:_.jsx("div",{className:`status-indicator ${g.color}`,children:_.jsx("span",{className:"status-icon",children:g.icon})})}):_.jsxs("div",{className:`status-bar ${e} ${c?"expanded":""}`,children:[_.jsxs("div",{className:"status-bar-main",onClick:()=>d(!c),role:"button",tabIndex:0,onKeyDown:e=>"Enter"===e.key&&d(!c),children:[_.jsxs("div",{className:"status-content",children:[_.jsx("div",{className:`status-indicator ${g.color}`,children:_.jsx("span",{className:"status-icon",children:g.icon})}),_.jsxs("div",{className:"status-text",children:[_.jsx("span",{className:"status-label",children:g.label}),r&&_.jsx("span",{className:"status-description",children:g.description})]}),i.syncInProgress&&_.jsx("div",{className:"sync-progress",children:_.jsx("div",{className:"sync-spinner"})}),i.pendingOperations>0&&_.jsx("div",{className:"pending-badge",children:i.pendingOperations})]}),_.jsx("div",{className:"expand-arrow "+(c?"rotated":""),children:_.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),c&&_.jsxs("div",{className:"status-bar-details",children:[_.jsxs("div",{className:"detail-section",children:[_.jsx("h4",{className:"detail-title",children:"连接状态"}),_.jsxs("div",{className:"detail-grid",children:[_.jsxs("div",{className:"detail-item",children:[_.jsx("span",{className:"detail-label",children:"网络:"}),_.jsx("span",{className:"detail-value "+(i.isOnline?"text-green-600":"text-red-600"),children:i.isOnline?"已连接":"离线"})]}),_.jsxs("div",{className:"detail-item",children:[_.jsx("span",{className:"detail-label",children:"实时连接:"}),_.jsx("span",{className:"detail-value "+(n?"text-green-600":"text-yellow-600"),children:n?"已连接":"未连接"})]}),_.jsxs("div",{className:"detail-item",children:[_.jsx("span",{className:"detail-label",children:"上次同步:"}),_.jsx("span",{className:"detail-value",children:(e=>{if(!e)return"从未同步";const t=(new Date).getTime()-e.getTime(),s=Math.floor(t/6e4),a=Math.floor(s/60),r=Math.floor(a/24);return r>0?`${r}天前`:a>0?`${a}小时前`:s>0?`${s}分钟前`:"刚刚"})(i.lastSyncTime)})]})]})]}),(i.pendingOperations>0||i.failedOperations>0)&&_.jsxs("div",{className:"detail-section",children:[_.jsx("h4",{className:"detail-title",children:"同步状态"}),_.jsxs("div",{className:"detail-grid",children:[i.pendingOperations>0&&_.jsxs("div",{className:"detail-item",children:[_.jsx("span",{className:"detail-label",children:"待同步:"}),_.jsxs("span",{className:"detail-value text-orange-600",children:[i.pendingOperations," 个操作"]})]}),i.failedOperations>0&&_.jsxs("div",{className:"detail-item",children:[_.jsx("span",{className:"detail-label",children:"失败:"}),_.jsxs("span",{className:"detail-value text-red-600",children:[i.failedOperations," 个操作"]})]})]})]}),_.jsxs("div",{className:"detail-section",children:[_.jsx("h4",{className:"detail-title",children:"存储使用"}),_.jsxs("div",{className:"storage-info",children:[_.jsx("div",{className:"storage-bar",children:_.jsx("div",{className:"storage-fill",style:{width:`${Math.min(m.percentage,100)}%`,backgroundColor:m.percentage>80?"#ef4444":m.percentage>60?"#f59e0b":"#10b981"}})}),_.jsxs("div",{className:"storage-text",children:[_.jsxs("span",{children:[p(m.used)," / ",p(m.quota)]}),_.jsxs("span",{className:"storage-percentage",children:["(",m.percentage.toFixed(1),"%)"]})]})]})]}),_.jsxs("div",{className:"detail-actions",children:[_.jsx("button",{onClick:async()=>{try{await l()}catch(e){}},disabled:!i.isOnline||i.syncInProgress,className:"action-button sync-button",children:i.syncInProgress?_.jsxs(_.Fragment,{children:[_.jsx("div",{className:"button-spinner"}),"同步中..."]}):_.jsxs(_.Fragment,{children:[_.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"立即同步"]})}),_.jsx("button",{onClick:()=>d(!1),className:"action-button close-button",children:"收起"})]}),!i.isOnline&&_.jsxs("div",{className:"status-tip offline-tip",children:[_.jsx("div",{className:"tip-icon",children:"💡"}),_.jsxs("div",{className:"tip-content",children:[_.jsx("p",{className:"tip-title",children:"离线模式"}),_.jsx("p",{className:"tip-description",children:"您的操作将保存在本地，网络恢复后自动同步"})]})]}),i.failedOperations>0&&_.jsxs("div",{className:"status-tip error-tip",children:[_.jsx("div",{className:"tip-icon",children:"⚠️"}),_.jsxs("div",{className:"tip-content",children:[_.jsx("p",{className:"tip-title",children:"同步失败"}),_.jsx("p",{className:"tip-description",children:"部分数据同步失败，请检查网络连接或稍后重试"})]})]})]})]})};var ht,pt;class gt{static async login(e){const t=await Xe(Ye.login,e);return Ke.setToken(t.access_token),t}static async register(e){const t=await Xe(Ye.register,e);return Ke.setToken(t.access_token),t}static async getProfile(){return await Qe(Ye.profile)}static async logout(){try{await Xe(Ye.logout)}catch(e){}finally{Ke.removeToken()}}static isAuthenticated(){return Ke.isTokenValid()}static getToken(){return Ke.getToken()}}const xt=()=>{const{user:e}=nt();return u.useEffect((()=>{if(e){const t=gt.getToken();return t&&a.connect(e.openid,t).then((()=>{})).catch((e=>{})),()=>{a.disconnect()}}}),[e]),null};u.lazy((()=>S((()=>import("./activity-features-BeCPKsHJ.js").then((e=>e.C))),__vite__mapDeps([0,1,2,3,4,5,6,7]))));const ft=({avatar:e,nickname:t,size:s=40,level:a,className:i="",isOnline:l=!1})=>{const o=e||"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",c=!e&&t,d=c?t[0].toUpperCase():null,u="number"==typeof(g=s)?g:{sm:32,md:40,lg:48,xl:64}[g]||40,m=e=>{const t=e.charCodeAt(0),s=[`linear-gradient(135deg, ${n.primary[500]} 0%, ${n.primary[600]} 100%)`,`linear-gradient(135deg, ${n.secondary[400]} 0%, ${n.secondary[600]} 100%)`,`linear-gradient(135deg, ${n.secondary[500]} 0%, ${n.secondary[500]} 100%)`,`linear-gradient(135deg, ${n.secondary[500]} 0%, ${n.primary[500]} 100%)`,`linear-gradient(135deg, ${n.neutral[500]} 0%, ${n.neutral[600]} 100%)`];return s[t%s.length]},h={width:`${u}px`,height:`${u}px`},p=Math.max(12,.4*u);var g,x;return _.jsxs("div",{className:`relative inline-flex items-center justify-center transition-all duration-300 ease-smooth hover:scale-105 ${i}`,style:h,children:[_.jsxs("div",{className:"relative w-full h-full rounded-full overflow-hidden transition-all duration-300 ease-smooth hover:shadow-lg",style:{boxShadow:r.soft,border:"3px solid rgba(255, 255, 255, 0.8)"},children:[c?_.jsx("div",{className:"flex items-center justify-center w-full h-full text-white font-bold backdrop-blur-sm",style:{background:m(d),fontSize:`${p}px`,textShadow:"0 1px 2px rgba(0, 0, 0, 0.3)"},children:d}):_.jsx("img",{src:o,alt:t||"User avatar",className:"w-full h-full object-cover transition-all duration-300 ease-smooth hover:scale-110",onError:e=>{e.currentTarget.style.display="none";const t=e.currentTarget.parentElement;if(t&&d){const e=document.createElement("div");e.className="flex items-center justify-center w-full h-full text-white font-bold backdrop-blur-sm",e.style.background=m(d),e.style.fontSize=`${p}px`,e.style.textShadow="0 1px 2px rgba(0, 0, 0, 0.3)",e.textContent=d,t.appendChild(e)}}}),_.jsx("div",{className:"absolute inset-0 opacity-20 pointer-events-none",style:{background:"linear-gradient(135deg, transparent 0%, rgba(0, 0, 0, 0.1) 50%, transparent 100%)"}})]}),l&&_.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 rounded-full border-2 border-white animate-pulse",style:{width:`${Math.max(8,.2*u)}px`,height:`${Math.max(8,.2*u)}px`,background:`linear-gradient(135deg, ${n.success.primary} 0%, #22C55E 100%)`,boxShadow:r.soft}}),void 0!==a&&_.jsx("div",{className:"absolute -top-1 -right-1 flex items-center justify-center text-xs font-bold rounded-full transition-all duration-300 ease-smooth hover:scale-110 cursor-default",style:{minWidth:`${Math.max(20,.4*u)}px`,height:`${Math.max(20,.4*u)}px`,fontSize:`${Math.max(10,.25*u)}px`,...(x=a,x>=8?{background:`linear-gradient(135deg, ${n.primary[500]} 0%, ${n.primary[600]} 100%)`,border:`2px solid ${n.primary[400]}`,color:"white"}:x>=5||x>=3?{background:`linear-gradient(135deg, ${n.secondary[500]} 0%, ${n.secondary[600]} 100%)`,border:`2px solid ${n.secondary[400]}`,color:"white"}:{background:`linear-gradient(135deg, ${n.neutral[400]} 0%, ${n.neutral[500]} 100%)`,border:`2px solid ${n.neutral[300]}`,color:"white"}),boxShadow:r.medium},title:`攀岩等级: ${a}`,children:_.jsxs("span",{className:"flex items-center gap-0.5",children:[a>=5&&_.jsx("span",{className:"text-yellow-300",style:{fontSize:`${Math.max(8,.2*u)}px`},children:"⭐"}),a]})}),_.jsx("div",{className:"absolute inset-0 rounded-full opacity-0 hover:opacity-100 transition-all duration-300 pointer-events-none",style:{background:`linear-gradient(135deg, ${n.primary[500]}20 0%, ${n.secondary[500]}20 100%)`,transform:"scale(1.1)"}})]})},yt=({src:e,alt:t,className:s="",style:a={},placeholder:r,fallback:i="/images/placeholder-climb.jpg",onLoad:l,onError:o,threshold:c=.1,rootMargin:d="50px",aspectRatio:m,enableBlur:h=!0,priority:p=!1})=>{const[g,x]=u.useState(!1),[f,y]=u.useState(p),[v,b]=u.useState(!1),[j,N]=u.useState(null),w=u.useRef(null),k=u.useRef(null),A=u.useCallback((e=>e),[]),S=u.useCallback((()=>{x(!0),l?.()}),[l]),C=u.useCallback((()=>{b(!0),N(i),o?.()}),[i,o]);u.useEffect((()=>{if(!p&&w.current)return k.current=new IntersectionObserver((([e])=>{e.isIntersecting&&(y(!0),k.current?.disconnect())}),{threshold:c,rootMargin:d}),k.current.observe(w.current),()=>{k.current?.disconnect()}}),[c,d,p]),u.useEffect((()=>{!f||j||v||N(A(e))}),[f,j,v,e,A]);const E={backgroundColor:n.neutral[200],background:`linear-gradient(135deg, ${n.neutral[100]} 0%, ${n.neutral[200]} 100%)`,display:"flex",alignItems:"center",justifyContent:"center",aspectRatio:m?`${m}`:"auto",minHeight:"120px",...a},L={transition:"all 0.4s cubic-bezier(0.4, 0, 0.2, 1)",opacity:g?1:0,filter:h&&!g?"blur(8px)":"none",transform:g?"scale(1)":"scale(1.05)",...a},O=()=>_.jsx("div",{className:`lazy-image-placeholder ${s}`,style:E,role:"img","aria-label":`Loading ${t}`,children:r?_.jsx("img",{src:r,alt:"",className:"w-full h-full object-cover opacity-50","aria-hidden":"true"}):_.jsxs("div",{className:"flex flex-col items-center gap-3",children:[_.jsxs("div",{className:"relative",children:[_.jsx("div",{className:"w-12 h-12 rounded-full animate-pulse",children:_.jsx("div",{className:"w-full h-full rounded-full",style:{background:`linear-gradient(135deg, ${n.primary[300]} 0%, ${n.secondary[300]} 100%)`}})}),_.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-xl animate-bounce",style:{animationDelay:"0.2s"},children:"🧗‍♀️"})]}),_.jsx("div",{className:"text-sm font-medium",style:{color:n.neutral[500]},children:"加载图片中..."})]})});return f?v&&!j?_.jsx("div",{className:`lazy-image-error ${s}`,style:{...E,background:`linear-gradient(135deg, ${n.neutral[100]} 0%, ${n.neutral[200]} 100%)`,border:`2px dashed ${n.neutral[300]}`},role:"img","aria-label":`Failed to load ${t}`,children:_.jsxs("div",{className:"flex flex-col items-center gap-3",children:[_.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-xl",style:{background:`linear-gradient(135deg, ${n.error.soft} 0%, ${n.error.subtle} 100%)`},children:"📷"}),_.jsx("div",{className:"text-sm font-medium text-center",style:{color:n.neutral[600]},children:"图片加载失败"})]})}):_.jsxs("div",{className:`lazy-image-container ${s}`,style:{position:"relative"},children:[!g&&O(),j&&_.jsx("img",{ref:w,src:j,alt:t,className:"lazy-image "+(g?"loaded":"loading"),style:{...L,position:g?"static":"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"cover",borderRadius:"inherit"},onLoad:S,onError:C,loading:p?"eager":"lazy",decoding:"async"})]}):O()};function vt({title:e,titleId:t,...s},a){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?u.createElement("title",{id:t},e):null,u.createElement("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z",clipRule:"evenodd"}))}const bt=u.forwardRef(vt);function jt({title:e,titleId:t,...s},a){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?u.createElement("title",{id:t},e):null,u.createElement("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm8.706-1.442c1.146-.573 2.437.463 2.126 1.706l-.709 2.836.042-.02a.75.75 0 0 1 .67 1.34l-.04.022c-1.147.573-2.438-.463-2.127-1.706l.71-2.836-.042.02a.75.75 0 1 1-.671-1.34l.041-.022ZM12 9a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z",clipRule:"evenodd"}))}const Nt=u.forwardRef(jt);function wt({title:e,titleId:t,...s},a){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:a,"aria-labelledby":t},s),e?u.createElement("title",{id:t},e):null,u.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm-1.72 6.97a.75.75 0 1 0-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 1 0 1.06 1.06L12 13.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L13.06 12l1.72-1.72a.75.75 0 1 0-1.06-1.06L12 10.94l-1.72-1.72Z",clipRule:"evenodd"}))}const kt=u.forwardRef(wt),_t=u.createContext(void 0),At=({children:e})=>{const[t,s]=u.useState([]),a=u.useCallback((e=>{const t=Date.now();s((s=>[...s,{...e,id:t}])),setTimeout((()=>{s((e=>e.filter((e=>e.id!==t))))}),3e3)}),[]),r=e=>{switch(e){case"success":return _.jsx(bt,{className:"w-6 h-6 text-green-500 mr-2"});case"fail":return _.jsx(kt,{className:"w-6 h-6 text-red-500 mr-2"});case"info":return _.jsx(Nt,{className:"w-6 h-6 text-blue-500 mr-2"});default:return null}},n=e=>{switch(e){case"top":return"top-5 left-1/2 -translate-x-1/2";case"bottom":return"bottom-5 left-1/2 -translate-x-1/2";default:return"top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2"}};return _.jsxs(_t.Provider,{value:{show:a},children:[e,_.jsx("div",{className:"fixed z-[1000]",children:t.map((e=>_.jsxs("div",{className:`p-4 rounded-md shadow-lg bg-gray-800 text-white flex items-center max-w-sm ${n(e.position)}`,children:[r(e.icon),_.jsx("span",{children:e.content})]},e.id)))})]})};var St=Object.defineProperty;class Ct extends u.Component{constructor(e){super(e),((e,t,s)=>{t in e?St(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s})(this,"handleReset"+"",(()=>{this.setState({hasError:!1,error:void 0})})),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){this.props.onError?.(e,t),i("出现了一个错误，请刷新页面重试")}render(){return this.state.hasError?this.props.fallback?this.props.fallback:_.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:_.jsx("div",{className:"max-w-md w-full text-center",children:_.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[_.jsx("div",{className:"mb-4",children:_.jsx("div",{className:"mx-auto w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:_.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.082 16.5c-.77.833.192 2.5 1.732 2.5z"})})})}),_.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"出现了一个错误"}),_.jsx("p",{className:"text-gray-600 mb-6",children:"抱歉，应用程序遇到了一个意外错误。请尝试刷新页面。"}),_.jsxs("div",{className:"space-y-3",children:[_.jsx("button",{onClick:this.handleReset,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors",children:"重试"}),_.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-gray-200 text-gray-800 py-2 px-4 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors",children:"刷新页面"})]}),!1]})})}):this.props.children}}var Et,Lt={exports:{}};const Ot=x(Et?Lt.exports:(Et=1,Lt.exports=function(e,t,s){e=e||{};var a=t.prototype,r={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function n(e,t,s,r){return a.fromToBase(e,t,s,r)}s.en.relativeTime=r,a.fromToBase=function(t,a,n,i,l){for(var o,c,d,u=n.$locale().relativeTime||r,m=e.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],h=m.length,p=0;p<h;p+=1){var g=m[p];g.d&&(o=i?s(t).diff(n,g.d,!0):n.diff(t,g.d,!0));var x=(e.rounding||Math.round)(Math.abs(o));if(d=o>0,x<=g.r||!g.r){x<=1&&p>0&&(g=m[p-1]);var f=u[g.l];l&&(x=l(""+x)),c="string"==typeof f?f.replace("%d",x):f(x,a,g.l,d);break}}if(a)return c;var y=d?u.future:u.past;return"function"==typeof y?y(c):y.replace("%s",c)},a.to=function(e,t){return n(e,t,this,!0)},a.from=function(e,t){return n(e,t,this)};var i=function(e){return e.$u?s.utc():s()};a.toNow=function(e){return this.to(i(this),e)},a.fromNow=function(e){return this.from(i(this),e)}}));var Tt,$t,Dt,Mt,Pt;Tt||(Tt=1,$t=v(),Mt=(Dt=$t)&&"object"==typeof Dt&&"default"in Dt?Dt:{default:Dt},Pt={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(e,t){return"W"===t?e+"周":e+"日"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(e,t){var s=100*e+t;return s<600?"凌晨":s<900?"早上":s<1100?"上午":s<1300?"中午":s<1800?"下午":"晚上"}},Mt.default.locale(Pt,null,!0)),Me.extend(Ot),Me.locale("zh-cn");const It=e=>{switch(e){case"activity_join":return _.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zM3 19.235v-.11a6.375 6.375 0 0112.75 0v.109A12.318 12.318 0 019.374 21c-2.331 0-4.512-.645-6.374-1.766z"})});case"new_comment":return _.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 01.865-.501 48.172 48.172 0 003.423-.379c1.584-.233 2.707-1.627 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0012 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018z"})});case"system_announcement":return _.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.34 15.84c-.688-.06-1.386-.09-2.09-.09H7.5a4.5 4.5 0 110-9h.75c.704 0 1.402-.03 2.09-.09m0 9.18c.253.962.584 1.892.985 2.783.247.55.06 1.21-.463 1.511l-.657.38c-.551.318-1.26.117-1.527-.461a20.845 20.845 0 01-1.44-4.282m3.102.069a18.03 18.03 0 01-.59-4.59c0-1.586.205-3.124.59-4.59m0 9.18a23.848 23.848 0 018.835 2.535M10.34 6.66a23.847 23.847 0 008.835-2.535m0 0A23.74 23.74 0 0018.795 3m.38 1.125a23.91 23.91 0 011.014 5.395m-1.014 8.855c-.118.38-.245.754-.38 1.125m.38-10.105c.118.38.245.754.38 1.125m-.755-6.715C20.365 9.999 21 11.45 21 13.125s-.635 3.126-1.605 4.375m-.755-6.715L18.25 7.5"})});default:return _.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0"})})}},Rt=e=>{switch(e){case"activity_join":return"活动报名";case"new_comment":return"新留言";case"system_announcement":return"系统公告";case"activity_update":return"活动更新";case"new_review":return"新评论";default:return"通知"}},Bt=e=>{switch(e){case"activity_join":return"#10B981";case"new_comment":return"#3B82F6";case"system_announcement":return"#F59E0B";case"activity_update":return"#8B5CF6";case"new_review":return"#EF4444";default:return"#6B7280"}},Ut=({notification:e,onClick:t})=>{const s=()=>{t&&t(e)},a=(new Date).getTime()-new Date(e.timestamp).getTime()<864e5;return _.jsxs("div",{role:"button",tabIndex:0,onClick:s,onKeyDown:e=>"Enter"===e.key&&s(),className:"notification-item "+(e.isRead?"read":"unread"),children:[_.jsxs("div",{className:"notification-item-content",children:[_.jsx("div",{className:"notification-icon-wrapper",style:{background:`linear-gradient(135deg, ${Bt(e.type)}20 0%, ${Bt(e.type)}10 100%)`,color:Bt(e.type)},children:It(e.type)}),_.jsxs("div",{className:"notification-content",children:[_.jsxs("div",{className:"notification-header",children:[_.jsx("span",{className:"notification-type-label",children:Rt(e.type)}),a&&_.jsx("span",{className:"new-notification-badge",children:"NEW"}),!e.isRead&&_.jsx("div",{className:"unread-indicator"})]}),_.jsx("div",{className:"notification-title",children:e.title}),_.jsx("div",{className:"notification-message",children:e.message}),_.jsx("div",{className:"notification-timestamp",children:Me(e.timestamp).fromNow()})]})]}),_.jsx("div",{className:"notification-chevron",children:_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})})})]})},zt=({notifications:e,onNotificationClick:t,isLoading:s})=>s?_.jsxs("div",{className:"p-4",children:[_.jsx("div",{className:"text-sm text-gray-500 mb-2 px-4 py-2",children:"通知列表"}),[1,2,3].map((e=>_.jsx("div",{className:"p-4 border-b border-gray-200 text-gray-400",children:"加载中..."},e)))]}):0===e.length?_.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-16 text-gray-500",children:[_.jsx("div",{className:"text-4xl mb-4",children:"📭"}),_.jsx("p",{children:"暂无通知"})]}):_.jsx("div",{className:"divide-y divide-gray-200",children:e.map((e=>_.jsx(Ut,{notification:e,onClick:t},e.id)))}),Ft=()=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0"})}),Yt=()=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.34 15.84c-.688-.06-1.386-.09-2.09-.09H7.5a4.5 4.5 0 110-9h.75c.704 0 1.402-.03 2.09-.09m0 9.18c.253.962.584 1.892.985 2.783.247.55.06 1.21-.463 1.511l-.657.38c-.551.318-1.26.117-1.527-.461a20.845 20.845 0 01-1.44-4.282m3.102.069a18.03 18.03 0 01-.59-4.59c0-1.586.205-3.124.59-4.59m0 9.18a23.848 23.848 0 018.835 2.535M10.34 6.66a23.847 23.847 0 008.835-2.535m0 0A23.74 23.74 0 0018.795 3m.38 1.125a23.91 23.91 0 011.014 5.395m-1.014 8.855c-.118.38-.245.754-.38 1.125m.38-10.105c.118.38.245.754.38 1.125m-.755-6.715C20.365 9.999 21 11.45 21 13.125s-.635 3.126-1.605 4.375m-.755-6.715L18.25 7.5"})}),Gt=[{id:"1",type:"activity_join",title:"🎉 报名成功: 周末欢乐抱石局",message:"您已成功报名 周末欢乐抱石局 活动。",timestamp:new Date(Date.now()-18e5),isRead:!1,linkTo:"/activity/1"},{id:"2",type:"new_comment",title:"💬 新留言: 关于先锋练习",message:"Alice 在 '先锋练习' 活动中发表了新留言。",timestamp:new Date(Date.now()-72e5),isRead:!0,linkTo:"/activity/some-other-id/comments"},{id:"3",type:"system_announcement",title:"🔧 系统维护通知",message:"本周日凌晨2-4点将进行系统维护。",timestamp:new Date(Date.now()-2592e5),isRead:!0},{id:"4",type:"new_review",title:"⭐ 新评价",message:"您参加的活动收到了新的评价。",timestamp:new Date(Date.now()-432e6),isRead:!0},{id:"5",type:"activity_update",title:"📅 活动更新",message:"您报名的活动时间有所调整。",timestamp:new Date(Date.now()-6048e5),isRead:!0}],Vt=({announcements:e=[],notificationCount:t=0,onAnnouncementClick:s,className:a=""})=>{const r=m(),[n,i]=u.useState(!1),[o,c]=u.useState(!1),[d,h]=u.useState(0),[p,g]=u.useState(Gt),[x]=u.useState(!1),[f,y]=u.useState(null),v=e.length>0||p.length>0,b=p.filter((e=>!e.isRead)).length;u.useEffect((()=>{if(e.length<=1)return;const t=setInterval((()=>{h((t=>t>=e.length-1?0:t+1))}),5e3);return()=>clearInterval(t)}),[e.length]);const j=u.useCallback((()=>{y("notifications"),c(!0)}),[]),N=u.useCallback((e=>{y("announcements"),i(!1),s?.(e)}),[s]),w=u.useCallback((e=>{g((t=>t.map((t=>t.id===e.id?{...t,isRead:!0}:t)))),y(null),c(!1),e.linkTo?r(e.linkTo):l("此通知没有可跳转的链接")}),[r]),k=u.useCallback((()=>{y(null),i(!1),c(!1)}),[]);if(u.useEffect((()=>{const e=e=>{"Escape"===e.key&&k()};if(f||n||o)return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}),[f,n,o,k]),!v)return null;const A=e[d]||e[0],S=e.length>1;return _.jsxs(_.Fragment,{children:[_.jsxs("div",{className:`notification-center ${a} ${f?"elevated":""}`,children:[_.jsxs("div",{className:"notification-bar",children:[_.jsxs("button",{onClick:j,className:"notification-bell-section "+("notifications"===f?"active":""),children:[_.jsxs("div",{className:"bell-icon-wrapper",children:[_.jsx(Ft,{}),t>0&&_.jsx("div",{className:"notification-badge",children:_.jsx("span",{className:"notification-count",children:t>99?"99+":t})})]}),_.jsxs("div",{className:"bell-content",children:[_.jsx("span",{className:"bell-label",children:"通知"}),b>0&&_.jsxs("span",{className:"bell-description",children:[b," 条新消息"]})]})]}),e.length>0&&b>0&&_.jsx("div",{className:"notification-divider"}),e.length>0&&_.jsx("div",{className:"announcement-section",children:_.jsxs("div",{className:"announcement-content "+("announcements"===f?"active":""),onClick:()=>N(A),children:[_.jsx("div",{className:"announcement-icon-wrapper",children:_.jsx(Yt,{})}),_.jsxs("div",{className:"announcement-text",children:[_.jsxs("div",{className:"announcement-header",children:[_.jsx("span",{className:"announcement-label",children:"公告"}),A.weight&&A.weight>=2&&_.jsx("span",{className:"priority-badge",children:"重要"}),(new Date).getTime()-new Date(A.createdAt).getTime()<6048e5&&_.jsx("span",{className:"new-badge",children:"NEW"}),S&&_.jsx("div",{className:"announcement-indicators",children:e.map(((e,t)=>_.jsx("div",{className:"indicator-dot "+(t===d?"active":"")},t)))})]}),_.jsx("span",{className:"announcement-title",children:A.title})]})]})})]}),f&&_.jsxs("div",{className:"expanded-content-area",children:["announcements"===f&&_.jsxs("div",{className:"expanded-announcements",children:[_.jsxs("div",{className:"expanded-header",children:[_.jsxs("div",{className:"expanded-title-section",children:[_.jsx("div",{className:"expanded-icon-wrapper",children:_.jsx(Yt,{})}),_.jsxs("div",{className:"expanded-header-text",children:[_.jsx("h3",{className:"expanded-title",children:"所有公告"}),_.jsx("div",{className:"expanded-meta",children:_.jsxs("span",{className:"expanded-date",children:[e.length," 条公告"]})})]})]}),_.jsx("button",{onClick:k,className:"expanded-close-button","aria-label":"关闭公告列表",children:_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),_.jsx("div",{className:"expanded-content",children:_.jsx("div",{className:"announcements-list",children:e.map(((e,t)=>_.jsxs("div",{className:"announcement-list-item "+(t===d?"current":""),onClick:()=>s?.(e),children:[_.jsx("div",{className:"announcement-list-icon",children:_.jsx(Yt,{})}),_.jsxs("div",{className:"announcement-list-content",children:[_.jsxs("div",{className:"announcement-list-header",children:[e.weight&&e.weight>=2&&_.jsx("span",{className:"priority-badge small",children:"重要"}),(new Date).getTime()-new Date(e.createdAt).getTime()<6048e5&&_.jsx("span",{className:"new-badge small",children:"NEW"}),_.jsx("span",{className:"announcement-list-date",children:new Date(e.createdAt).toLocaleDateString("zh-CN")})]}),_.jsx("h4",{className:"announcement-list-title",children:e.title}),_.jsx("p",{className:"announcement-list-preview",children:e.content})]})]},e.id)))})})]}),"notifications"===f&&_.jsxs("div",{className:"expanded-notifications",children:[_.jsxs("div",{className:"expanded-header",children:[_.jsxs("div",{className:"expanded-title-section",children:[_.jsxs("div",{className:"expanded-icon-wrapper",children:[_.jsx(Ft,{}),b>0&&_.jsx("div",{className:"expanded-notification-badge",children:_.jsx("span",{className:"expanded-notification-count",children:b>99?"99+":b})})]}),_.jsxs("div",{className:"expanded-header-text",children:[_.jsx("h3",{className:"expanded-title",children:"我的通知"}),_.jsx("span",{className:"expanded-subtitle",children:b>0?`${b} 条未读消息`:"所有消息已读"})]})]}),_.jsx("button",{onClick:k,className:"expanded-close-button","aria-label":"关闭通知列表",children:_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),_.jsx("div",{className:"expanded-content",children:_.jsx(zt,{notifications:p,onNotificationClick:w,isLoading:x})})]})]})]}),f&&_.jsx("div",{className:"elevated-overlay",onClick:k,children:_.jsx("div",{className:"elevated-backdrop"})}),n&&S&&!f&&_.jsxs("div",{className:"notification-overlay",onClick:k,children:[_.jsx("div",{className:"notification-overlay-backdrop"}),_.jsxs("div",{className:"floating-announcements",onClick:e=>e.stopPropagation(),children:[_.jsxs("div",{className:"floating-header",children:[_.jsx("h3",{className:"floating-title",children:"所有公告"}),_.jsx("button",{onClick:k,className:"floating-close-button","aria-label":"关闭公告列表",children:_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),_.jsx("div",{className:"floating-content",children:e.map(((e,t)=>_.jsxs("button",{onClick:()=>{N(e),k()},className:"floating-announcement-item "+(t===d?"active":""),children:[_.jsx("div",{className:"floating-announcement-icon",children:_.jsx(Yt,{})}),_.jsxs("div",{className:"floating-announcement-content",children:[_.jsxs("div",{className:"floating-announcement-header",children:[e.weight&&e.weight>=2&&_.jsx("span",{className:"priority-badge small",children:"重要"}),(new Date).getTime()-new Date(e.createdAt).getTime()<6048e5&&_.jsx("span",{className:"new-badge small",children:"NEW"})]}),_.jsx("span",{className:"floating-announcement-title",children:e.title}),_.jsx("span",{className:"floating-announcement-date",children:new Date(e.createdAt).toLocaleDateString("zh-CN")})]})]},t)))})]})]}),o&&!f&&_.jsx("div",{className:"notification-dropdown-overlay",onClick:k,children:_.jsxs("div",{className:"notification-dropdown",onClick:e=>e.stopPropagation(),children:[_.jsxs("div",{className:"dropdown-header",children:[_.jsxs("div",{className:"dropdown-title-section",children:[_.jsxs("div",{className:"dropdown-icon-wrapper",children:[_.jsx(Ft,{}),b>0&&_.jsx("div",{className:"dropdown-notification-badge",children:_.jsx("span",{className:"dropdown-notification-count",children:b>99?"99+":b})})]}),_.jsxs("div",{className:"dropdown-header-text",children:[_.jsx("h3",{className:"dropdown-title",children:"我的通知"}),_.jsx("span",{className:"dropdown-subtitle",children:b>0?`${b} 条未读消息`:"所有消息已读"})]})]}),_.jsx("button",{onClick:k,className:"dropdown-close-button","aria-label":"关闭通知列表",children:_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),_.jsx("div",{className:"dropdown-content",children:_.jsx(zt,{notifications:p,onNotificationClick:w,isLoading:x})})]})})]})},Ht=()=>{const e=m(),t=h(),{announcements:s}=rt((e=>({announcements:e.announcements,theme:e.theme,error:e.error,isLoadingAnnouncements:e.isLoadingAnnouncements}))),a=(()=>{const e=t.pathname;return"/"===e||e.startsWith("/activity")?"activities":e.startsWith("/profile")||e.startsWith("/my-activities")?"my":e.startsWith("/create-activity")?"create":"activities"})(),r=t=>{"activities"===t?e("/"):"my"===t?e("/profile"):"create"===t&&e("/create-activity")},n=d.useCallback((e=>{l(`查看公告: ${e.title}`)}),[]),[i]=d.useState(3),[o]=d.useState(!0);return _.jsxs("div",{className:"flex flex-col h-screen bg-gray-50",children:[_.jsx("div",{className:"bg-white shadow-sm border-b border-gray-100 p-4",children:_.jsx(Vt,{announcements:s,notificationCount:i,hasNewNotifications:o,onAnnouncementClick:n,className:"w-full"})}),_.jsx("main",{className:"flex-1 overflow-y-auto pb-20",children:_.jsx(p,{})}),_.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 z-50",children:_.jsxs("div",{className:"flex items-center justify-around h-16 px-4",children:[_.jsxs("button",{className:"relative flex flex-col items-center justify-center py-2 px-3 rounded-xl transition-all duration-200 "+("activities"===a?"text-orange-500 bg-orange-50":"text-gray-500 hover:text-gray-700"),onClick:()=>r("activities"),children:[_.jsx("i",{className:"fas fa-mountain text-xl "+("activities"===a?"text-orange-500":"text-gray-500")}),_.jsx("span",{className:"text-xs mt-1 font-medium",children:"Activities"}),"activities"===a&&_.jsx("div",{className:"absolute -bottom-2 left-1/2 transform -translate-x-1/2 w-8 h-0.5 bg-orange-500 rounded-full"})]}),_.jsxs("button",{className:"relative flex flex-col items-center justify-center p-3 rounded-2xl transition-all duration-300 "+("create"===a?"bg-gradient-to-r from-orange-500 to-pink-500 text-white transform scale-110":"bg-gradient-to-r from-orange-400 to-pink-400 text-white hover:scale-105"),onClick:()=>r("create"),children:[_.jsx("div",{className:"w-8 h-8 flex items-center justify-center",children:_.jsx("i",{className:"fas fa-plus text-xl"})}),_.jsx("span",{className:"text-xs mt-1 font-medium",children:"Create"}),"create"===a&&_.jsx("div",{className:"absolute -top-1 left-1/2 transform -translate-x-1/2 w-2 h-2 bg-white rounded-full"})]}),_.jsxs("button",{className:"relative flex flex-col items-center justify-center py-2 px-3 rounded-xl transition-all duration-200 "+("my"===a?"text-orange-500 bg-orange-50":"text-gray-500 hover:text-gray-700"),onClick:()=>r("my"),children:[_.jsx("i",{className:"fas fa-user text-xl "+("my"===a?"text-orange-500":"text-gray-500")}),_.jsx("span",{className:"text-xs mt-1 font-medium",children:"My"}),"my"===a&&_.jsx("div",{className:"absolute -bottom-2 left-1/2 transform -translate-x-1/2 w-8 h-0.5 bg-orange-500 rounded-full"})]})]})})]})},Wt=({onRefresh:e,children:t,isRefreshing:s=!1,threshold:a=80,maxPullDistance:r=120})=>{const[n,i]=u.useState(0),[l,o]=u.useState(!1),[c,d]=u.useState(0),m=u.useRef(null),h=u.useCallback((e=>{m.current&&0===m.current.scrollTop&&(d(e.touches[0].clientY),o(!0))}),[]),p=u.useCallback((e=>{if(!l||!m.current)return;const t=e.touches[0].clientY-c;if(t>0&&0===m.current.scrollTop){e.preventDefault();const s=Math.min(.5*t,r);i(s)}}),[l,c,r]),g=u.useCallback((async()=>{l&&(o(!1),n>=a&&!s&&await e(),i(0))}),[l,n,a,e,s]);return u.useEffect((()=>{const e=m.current;if(e)return e.addEventListener("touchstart",h,{passive:!1}),e.addEventListener("touchmove",p,{passive:!1}),e.addEventListener("touchend",g),()=>{e.removeEventListener("touchstart",h),e.removeEventListener("touchmove",p),e.removeEventListener("touchend",g)}}),[h,p,g]),u.useEffect((()=>{s&&i(0)}),[s]),_.jsxs("div",{ref:m,className:"pull-to-refresh-container",style:{transform:`translateY(${n}px)`,transition:l?"none":"transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:[_.jsx("div",{className:"pull-to-refresh-indicator",style:{height:`${Math.max(n,s?80:0)}px`,opacity:Math.min(n/a,1)},children:_.jsxs("div",{className:"refresh-content",children:[_.jsx("div",{className:"refresh-icon "+(s?"rotate-360":n>=a?"rotate-180":"rotate-0"),children:s?_.jsxs("div",{className:"climbing-animation",children:[_.jsx("span",{className:"climber",children:"🧗‍♀️"}),_.jsx("div",{className:"rope"})]}):_.jsx("span",{className:"arrow",children:"⬇️"})}),_.jsx("span",{className:"refresh-text",children:s?"🧗‍♀️ 正在刷新...":n>=a?"🚀 释放刷新":"⬇️ 下拉刷新"})]})}),_.jsx("div",{className:"content",children:t})]})},qt=({children:e,hasMore:t,loadMore:s,loading:a,threshold:r=200,endMessage:n,loader:i})=>{const l=u.useRef(null),o=u.useRef(!1),c=u.useCallback((()=>{if(!l.current||o.current||!t||a)return;const{scrollTop:e,scrollHeight:n,clientHeight:i}=l.current;n-e-i<=r&&(o.current=!0,s())}),[t,a,s,r]);u.useEffect((()=>{a||(o.current=!1)}),[a]),u.useEffect((()=>{const e=l.current;if(!e)return;const t=()=>{c()};return e.addEventListener("scroll",t,{passive:!0}),c(),()=>{e.removeEventListener("scroll",t)}}),[c]);const d=_.jsx("div",{className:"infinite-scroll-loader",children:_.jsxs("div",{className:"loading-content",children:[_.jsxs("div",{className:"climbing-dots",children:[_.jsx("div",{className:"dot dot-1",children:"🧗‍♀️"}),_.jsx("div",{className:"dot dot-2",children:"🧗‍♂️"}),_.jsx("div",{className:"dot dot-3",children:"🧗‍♀️"})]}),_.jsx("span",{className:"loading-text",children:"加载更多活动中..."})]})}),m=_.jsx("div",{className:"infinite-scroll-end",children:_.jsxs("div",{className:"end-content",children:[_.jsx("div",{className:"summit-icon",children:"🏔️"}),_.jsx("span",{className:"end-text",children:"已到达顶峰！没有更多活动了"})]})});return _.jsxs("div",{ref:l,className:"infinite-scroll-container",children:[_.jsx("div",{className:"infinite-scroll-content",children:e}),a&&(i||d),!t&&!a&&(n||m)]})},Kt=({isSearching:e})=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-5 h-5 transition-all duration-300 "+(e?"animate-pulse text-primary-500":"text-neutral-400"),children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),Jt=()=>_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-5 h-5",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),Zt=()=>_.jsxs("div",{className:"flex items-center space-x-1",children:[_.jsx("div",{className:"w-2 h-2 bg-primary-500 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),_.jsx("div",{className:"w-2 h-2 bg-primary-500 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),_.jsx("div",{className:"w-2 h-2 bg-primary-500 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),Qt=({activity:e,searchTerm:t,onClick:s})=>{const a=(e,t)=>{if(!t)return e;const s=new RegExp(`(${t})`,"gi");return e.split(s).map(((e,t)=>s.test(e)?_.jsx("span",{className:"font-bold rounded px-1",style:{background:`linear-gradient(135deg, ${n.primary[100]} 0%, ${n.primary[200]} 100%)`,color:n.primary[700]},children:e},t):e))},i=e=>({[Oe.BOULDERING]:"🧗‍♀️",[Oe.TOP_ROPE_AUTO_BELAY]:"🔗",[Oe.TOP_ROPE_MANUAL_BELAY]:"🔗",[Oe.LEAD_CLIMBING]:"🚀",[Oe.OUTDOOR]:"🏔️",[Oe.TRAINING]:"💪"}[e]||"🧗‍♀️");return _.jsxs("div",{onClick:()=>s(e),className:"p-4 cursor-pointer transition-all duration-200 hover:scale-[1.02] active:scale-[0.98] rounded-xl mb-2",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%)",border:`1px solid ${n.neutral[200]}`,boxShadow:r.soft},onMouseEnter:e=>{e.currentTarget.style.borderColor=n.primary[300],e.currentTarget.style.boxShadow=r.medium},onMouseLeave:e=>{e.currentTarget.style.borderColor=n.neutral[200],e.currentTarget.style.boxShadow=r.soft},children:[_.jsxs("div",{className:"flex items-start justify-between mb-2",children:[_.jsx("h3",{className:"font-semibold text-base leading-tight",children:a(e.title,t)}),_.jsx("div",{className:"flex gap-1 ml-2",children:e.types.map(((e,t)=>_.jsx("span",{className:"text-lg",children:i(e)},t)))})]}),_.jsxs("p",{className:"text-sm mb-2",style:{color:n.neutral[600]},children:["📍 ",a(e.locationText,t)]}),_.jsxs("div",{className:"flex items-center justify-between text-xs",children:[_.jsxs("span",{style:{color:n.neutral[500]},children:["👥 ",e.participantCount,"/",e.slotMax]}),_.jsxs("span",{style:{color:n.neutral[500]},children:["⏰ ",new Date(e.datetime).toLocaleDateString()]})]})]})},Xt=({label:e,onRemove:t,type:s="activity"})=>_.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium transition-all duration-200 hover:scale-105 active:scale-95 animate-fade-in",style:(()=>{switch(s){case"search":return{background:`linear-gradient(135deg, ${n.primary[100]} 0%, ${n.primary[200]} 100%)`,color:n.primary[700],border:`1px solid ${n.primary[300]}`};case"grade":return{background:`linear-gradient(135deg, ${n.secondary[100]} 0%, ${n.secondary[200]} 100%)`,color:n.secondary[700],border:`1px solid ${n.secondary[300]}`};default:return{background:`linear-gradient(135deg, ${n.neutral[100]} 0%, ${n.neutral[200]} 100%)`,color:n.neutral[700],border:`1px solid ${n.neutral[300]}`}}})(),children:[_.jsx("span",{className:"max-w-32 truncate",children:e}),_.jsx("button",{onClick:t,className:"p-0.5 rounded-full hover:bg-black hover:bg-opacity-10 transition-colors duration-200",children:_.jsx(Jt,{})})]}),es=({activities:e,onSearchResults:t,onActivityClick:s,placeholder:a="🔍 实时搜索活动名称或地点...",debounceMs:i=300,maxResults:l=10,filters:o={types:[],grades:[]},onFiltersChange:c})=>{const[d,m]=u.useState(""),[h,p]=u.useState(!1),[g,x]=u.useState(!1),[f,y]=u.useState([]),[v,b]=u.useState([]),[j,N]=u.useState(!1),[w,k]=u.useState(!1),A=u.useRef(null),S=u.useRef(null),C=u.useRef(null),E=u.useRef(),L=u.useCallback((s=>{if(!s.trim())return y([]),t([]),void p(!1);p(!0),setTimeout((()=>{const a=e.filter((e=>{const t=e.title.toLowerCase().includes(s.toLowerCase())||e.locationText.toLowerCase().includes(s.toLowerCase()),a=0===o.types.length||o.types.some((t=>e.types.includes(t))),r=0===o.grades.length||e.grades&&e.grades.some((e=>o.grades.includes(e)));return t&&a&&r})).slice(0,l).sort(((e,t)=>{const a=e.title.toLowerCase().includes(s.toLowerCase()),r=t.title.toLowerCase().includes(s.toLowerCase());return a&&!r?-1:!a&&r?1:new Date(e.datetime).getTime()-new Date(t.datetime).getTime()}));y(a),t(a),p(!1)}),100)}),[e,o,l,t]),O=e=>{const t=e||d;t.trim()&&(b((e=>{const s=[t,...e.filter((e=>e!==t))].slice(0,5);return localStorage.setItem("recentSearches",JSON.stringify(s)),s})),L(t),x(!1),A.current?.blur())},T=()=>{m(""),y([]),x(!1),t([]),E.current&&clearTimeout(E.current),A.current?.focus()},$=e=>{s(e),x(!1),A.current?.blur()};u.useEffect((()=>{const e=localStorage.getItem("recentSearches");if(e)try{b(JSON.parse(e))}catch($t){}}),[]),u.useEffect((()=>{const e=e=>{!S.current||S.current.contains(e.target)||A.current?.contains(e.target)||x(!1),!C.current||C.current.contains(e.target)||e.target?.closest('button[title="筛选选项"]')||k(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[]),u.useEffect((()=>()=>{E.current&&clearTimeout(E.current)}),[]);const D=d||o.types.length>0||o.grades.length>0,M=()=>{d||g||N(!1)},P=()=>_.jsx("div",{ref:C,className:"absolute top-full right-0 mt-2 w-80 z-50 rounded-xl overflow-hidden backdrop-blur-lg animate-fade-in",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.9) 100%)",border:`1px solid ${n.neutral[200]}`,boxShadow:r.large},children:_.jsxs("div",{className:"p-4",children:[_.jsxs("div",{className:"flex items-center justify-between mb-4",children:[_.jsx("h3",{className:"text-lg font-semibold",style:{color:n.neutral[700]},children:"筛选选项"}),_.jsx("button",{onClick:()=>k(!1),className:"p-1 rounded-full hover:bg-neutral-100 transition-colors",children:_.jsx(Jt,{})})]}),_.jsxs("div",{className:"mb-4",children:[_.jsx("h4",{className:"text-sm font-medium mb-2",style:{color:n.neutral[600]},children:"活动类型"}),_.jsx("div",{className:"flex flex-wrap gap-2",children:["户外","室内","攀岩","溯溪","徒步","野营"].map((e=>_.jsx("button",{onClick:()=>{const t=o.types.includes(e)?o.types.filter((t=>t!==e)):[...o.types,e];c?.({...o,types:t})},className:"px-3 py-1.5 rounded-lg text-sm font-medium transition-all duration-200 "+(o.types.includes(e)?"text-white":"hover:scale-105"),style:{background:o.types.includes(e)?`linear-gradient(135deg, ${n.primary[500]} 0%, ${n.primary[600]} 100%)`:`linear-gradient(135deg, ${n.neutral[100]} 0%, ${n.neutral[200]} 100%)`,color:o.types.includes(e)?"white":n.neutral[700],border:`1px solid ${o.types.includes(e)?n.primary[500]:n.neutral[300]}`},children:e},e)))})]}),_.jsxs("div",{className:"mb-4",children:[_.jsx("h4",{className:"text-sm font-medium mb-2",style:{color:n.neutral[600]},children:"难度等级"}),_.jsx("div",{className:"flex flex-wrap gap-2",children:["初级","中级","高级","专业"].map((e=>_.jsx("button",{onClick:()=>{const t=o.grades.includes(e)?o.grades.filter((t=>t!==e)):[...o.grades,e];c?.({...o,grades:t})},className:"px-3 py-1.5 rounded-lg text-sm font-medium transition-all duration-200 "+(o.grades.includes(e)?"text-white":"hover:scale-105"),style:{background:o.grades.includes(e)?`linear-gradient(135deg, ${n.secondary[500]} 0%, ${n.secondary[600]} 100%)`:`linear-gradient(135deg, ${n.neutral[100]} 0%, ${n.neutral[200]} 100%)`,color:o.grades.includes(e)?"white":n.neutral[700],border:`1px solid ${o.grades.includes(e)?n.secondary[500]:n.neutral[300]}`},children:e},e)))})]}),_.jsxs("div",{className:"flex items-center gap-2 pt-3 border-t",style:{borderColor:n.neutral[200]},children:[_.jsx("button",{onClick:()=>{c?.({types:[],grades:[]})},className:"flex-1 py-2 px-4 rounded-lg text-sm font-medium transition-all duration-200 hover:scale-105",style:{background:`linear-gradient(135deg, ${n.neutral[100]} 0%, ${n.neutral[200]} 100%)`,color:n.neutral[700],border:`1px solid ${n.neutral[300]}`},children:"清除筛选"}),_.jsx("button",{onClick:()=>k(!1),className:"flex-1 py-2 px-4 rounded-lg text-sm font-medium text-white transition-all duration-200 hover:scale-105",style:{background:`linear-gradient(135deg, ${n.primary[500]} 0%, ${n.primary[600]} 100%)`,border:`1px solid ${n.primary[500]}`},children:"确定"})]})]})});return _.jsxs("div",{className:"relative w-full",children:[j?_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:"relative group",children:[_.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:_.jsx(Kt,{isSearching:h})}),_.jsx("input",{ref:A,type:"text",value:d,onChange:e=>{const t=e.target.value;m(t),x(!0),E.current&&clearTimeout(E.current),E.current=setTimeout((()=>{L(t)}),i)},onFocus:e=>{x(!0),e.target.style.borderColor=n.primary[400],e.target.style.boxShadow=`0 0 0 4px ${n.primary[100]}`},onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),O()),"Escape"===e.key&&(x(!1),M(),A.current?.blur())},placeholder:a,className:"w-full pl-12 pr-12 py-3 text-base font-medium rounded-xl transition-all duration-300 ease-out focus:outline-none focus:ring-4",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%)",border:`2px solid ${n.neutral[200]}`,boxShadow:r.soft,color:n.neutral[800]},onBlur:e=>{e.target.style.borderColor=n.neutral[200],e.target.style.boxShadow=r.soft,setTimeout(M,150)}}),_.jsx("div",{className:"absolute inset-y-0 right-0 pr-4 flex items-center",children:h?_.jsx(Zt,{}):d?_.jsx("button",{onClick:T,className:"text-neutral-400 hover:text-neutral-600 transition-colors duration-200 p-1 rounded-full hover:bg-neutral-100",children:_.jsx(Jt,{})}):_.jsx("button",{onClick:M,className:"text-neutral-400 hover:text-neutral-600 transition-colors duration-200 p-1 rounded-full hover:bg-neutral-100",title:"收起搜索",children:_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"})})})})]}),D&&_.jsxs("div",{className:"flex flex-wrap gap-2 mt-3 animate-fade-in",children:[d&&_.jsx(Xt,{label:`搜索: "${d}"`,onRemove:()=>{T()},type:"search"}),o.types.map((e=>_.jsx(Xt,{label:`类型: ${e}`,onRemove:()=>{return t=e,void(c&&c({...o,types:o.types.filter((e=>e!==t))}));var t},type:"activity"},e))),o.grades.map((e=>_.jsx(Xt,{label:`难度: ${e}`,onRemove:()=>{return t=e,void(c&&c({...o,grades:o.grades.filter((e=>e!==t))}));var t},type:"grade"},e)))]}),g&&(d||v.length>0)&&_.jsx("div",{ref:S,className:"absolute top-full left-0 right-0 mt-2 z-50 rounded-2xl overflow-hidden backdrop-blur-lg animate-fade-in",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.9) 100%)",border:`1px solid ${n.neutral[200]}`,boxShadow:r.large,maxHeight:"70vh",overflowY:"auto"},children:d?_.jsx(_.Fragment,{children:h?_.jsxs("div",{className:"p-6 text-center",children:[_.jsx(Zt,{}),_.jsx("p",{className:"mt-2 text-sm",style:{color:n.neutral[600]},children:"正在搜索..."})]}):f.length>0?_.jsxs("div",{className:"p-4",children:[_.jsxs("h3",{className:"text-sm font-semibold mb-3 px-2",style:{color:n.neutral[700]},children:["🎯 搜索结果 (",f.length,")"]}),f.map((e=>_.jsx(Qt,{activity:e,searchTerm:d,onClick:$},e.id)))]}):_.jsxs("div",{className:"p-6 text-center",children:[_.jsx("div",{className:"text-4xl mb-2",children:"🔍"}),_.jsx("p",{className:"text-lg font-semibold mb-1",style:{color:n.neutral[600]},children:"未找到相关活动"}),_.jsx("p",{className:"text-sm",style:{color:n.neutral[500]},children:"尝试其他关键词或调整筛选条件"})]})}):v.length>0&&_.jsxs("div",{className:"p-4",children:[_.jsx("h3",{className:"text-sm font-semibold mb-3 px-2",style:{color:n.neutral[700]},children:"⏱️ 最近搜索"}),v.map(((e,t)=>_.jsx("button",{onClick:()=>{m(e),O(e)},className:"w-full text-left p-3 rounded-xl mb-2 transition-all duration-200 hover:scale-[1.02] active:scale-[0.98]",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.6) 0%, rgba(255, 255, 255, 0.4) 100%)",border:`1px solid ${n.neutral[200]}`},onMouseEnter:e=>{e.currentTarget.style.borderColor=n.primary[300]},onMouseLeave:e=>{e.currentTarget.style.borderColor=n.neutral[200]},children:_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx("div",{className:"text-lg",children:"🕐"}),_.jsx("span",{className:"font-medium",children:e})]})},t)))]})})]}):_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsxs("button",{onClick:()=>{N(!0),setTimeout((()=>{A.current?.focus()}),150)},className:"flex items-center gap-2 px-4 py-2 rounded-xl transition-all duration-200 hover:scale-105 active:scale-95",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%)",border:`1px solid ${n.neutral[200]}`,boxShadow:r.soft},children:[_.jsx(Kt,{}),_.jsx("span",{className:"text-sm font-medium",style:{color:n.neutral[600]},children:"点击搜索活动..."})]}),_.jsxs("button",{onClick:()=>{k(!w)},className:"flex items-center justify-center w-10 h-10 rounded-xl transition-all duration-200 hover:scale-105 active:scale-95 relative",style:{background:D?`linear-gradient(135deg, ${n.primary[100]} 0%, ${n.primary[200]} 100%)`:"linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%)",border:`1px solid ${D?n.primary[300]:n.neutral[200]}`,boxShadow:r.soft,color:D?n.primary[600]:n.neutral[500]},title:"筛选选项",children:[_.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:_.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 01-.659 1.591l-5.432 5.432a2.25 2.25 0 00-.659 1.591v2.927a2.25 2.25 0 01-1.244 2.013L9.75 21v-6.568a2.25 2.25 0 00-.659-1.591L3.659 7.409A2.25 2.25 0 013 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0112 3z"})}),D&&_.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-orange-400 rounded-full border border-white"})]})]}),w&&_.jsx(P,{})]})},ts=({children:e,onClick:t,variant:s="primary",size:a="md",loading:r=!1,disabled:n=!1,type:i="button",className:l="",startIcon:c,endIcon:d,fullWidth:u=!1})=>{const m=["inline-flex","items-center","justify-center","font-medium","rounded-lg","transition-all","duration-200","ease-smooth","focus:outline-none","focus:ring-2","focus:ring-offset-2","transform","active:scale-95","disabled:transform-none","disabled:cursor-not-allowed","disabled:opacity-50","relative","overflow-hidden"].join(" "),h={primary:["bg-gradient-to-r from-primary-500 to-primary-600","text-white","shadow-soft","hover:from-primary-600 hover:to-primary-700","hover:shadow-medium","focus:ring-primary-500","active:from-primary-700 active:to-primary-800"].join(" "),secondary:["bg-gradient-to-r from-secondary-500 to-secondary-600","text-white","shadow-soft","hover:from-secondary-600 hover:to-secondary-700","hover:shadow-medium","focus:ring-secondary-500","active:from-secondary-700 active:to-secondary-800"].join(" "),outline:["bg-transparent","text-primary-600","border-2 border-primary-500","hover:bg-primary-50","hover:text-primary-700","hover:border-primary-600","focus:ring-primary-500","active:bg-primary-100"].join(" "),ghost:["bg-transparent","text-neutral-700","hover:bg-neutral-100","hover:text-neutral-800","focus:ring-neutral-500","active:bg-neutral-200"].join(" ")},p=u?"w-full":"",g=()=>_.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:_.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[_.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),_.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),x=_.jsxs(_.Fragment,{children:[c&&!r&&_.jsx("span",{className:"flex-shrink-0",children:c}),_.jsx("span",{className:r?"opacity-0":"opacity-100",children:e}),d&&!r&&_.jsx("span",{className:"flex-shrink-0",children:d}),r&&_.jsx(g,{})]});return _.jsx("button",{type:i,onClick:t,disabled:n||r,className:`\n        ${m}\n        ${{sm:"px-3 py-2 text-sm min-h-[36px] gap-1.5",md:"px-4 py-2.5 text-sm min-h-[40px] gap-2",lg:"px-6 py-3 text-base min-h-[44px] gap-2.5"}[a]}\n        ${h[s]}\n        ${p}\n        ${l}\n      `,style:{transitionProperty:"all",transitionTimingFunction:o.easings.smooth,transitionDuration:o.normal},children:x})},ss=({placeholder:e,value:t,onChange:s,rows:a=2,maxLength:r,disabled:n,className:i=""})=>_.jsx("textarea",{placeholder:e,value:t,onChange:e=>s(e.target.value),rows:a,maxLength:r,disabled:n,className:`w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 resize-none disabled:bg-gray-100 ${i}`}),as=({value:e,onChange:t,placeholder:s="Select date and time",min:a,max:r,className:n="",label:i})=>{const l=e=>{if(e)return Me(e).format("YYYY-MM-DDTHH:mm")};return _.jsxs("div",{className:`flex flex-col ${n}`,children:[i&&_.jsx("label",{className:"mb-1 text-sm font-medium text-gray-700",children:i}),_.jsx("input",{type:"datetime-local",value:(o=e,o?Me(o).format("YYYY-MM-DDTHH:mm"):""),onChange:e=>{if(t){const s=e.target.value?new Date(e.target.value):void 0;s&&t(s)}},min:l(a),max:l(r),placeholder:s,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm disabled:bg-gray-50 disabled:cursor-not-allowed"})]});var o};class rs{static async getAll(){return await Qe(Ve.base)}static async getById(e){return await Qe(Ve.byId(e))}static async getByCity(e){return await Qe(Ve.byCity(e))}static async search(e){return await Qe(Ve.search,e)}static async create(e){return await Xe(Ve.base,e)}static async update(e,t){return await et(Ve.byId(e),t)}static async delete(e){await tt(Ve.byId(e))}static async getCities(){const e=await this.getAll();return[...new Set(e.map((e=>e.city)))].sort()}}const ns=({selectedGymId:e,onGymSelect:t,className:s="",placeholder:a="选择岩馆",required:r=!1})=>{const[n,l]=u.useState([]),[o,c]=u.useState([]),[d,m]=u.useState(""),[h,p]=u.useState([]),[g,x]=u.useState(!0),[f,y]=u.useState("");return u.useEffect((()=>{(async()=>{try{x(!0);const[e,t]=await Promise.all([rs.getAll(),rs.getCities()]);l(e),c(t),p(e)}catch(e){i(e instanceof qe?`加载岩馆列表失败: ${e.message}`:"加载岩馆列表失败")}finally{x(!1)}})()}),[]),u.useEffect((()=>{let e=n;if(d&&(e=e.filter((e=>e.city===d))),f.trim()){const t=f.toLowerCase();e=e.filter((e=>e.name.toLowerCase().includes(t)||e.address.toLowerCase().includes(t)))}p(e)}),[n,d,f]),g?_.jsxs("div",{className:`space-y-2 ${s}`,children:[_.jsx("div",{className:"animate-pulse bg-gray-200 h-10 rounded-lg"}),_.jsx("div",{className:"animate-pulse bg-gray-200 h-10 rounded-lg"}),_.jsx("div",{className:"animate-pulse bg-gray-200 h-10 rounded-lg"})]}):_.jsxs("div",{className:`space-y-3 ${s}`,children:[_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"城市"}),_.jsxs("select",{value:d,onChange:e=>{m(e.target.value)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[_.jsx("option",{value:"",children:"全部城市"}),o.map((e=>_.jsx("option",{value:e,children:e},e)))]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"搜索岩馆"}),_.jsx("input",{type:"text",value:f,onChange:e=>{y(e.target.value)},placeholder:"输入岩馆名称或地址...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),_.jsxs("div",{children:[_.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["选择岩馆 ",r&&_.jsx("span",{className:"text-red-500",children:"*"})]}),_.jsxs("select",{value:e||"",onChange:e=>{const s=parseInt(e.target.value);if(s){const e=n.find((e=>e.id===s));e&&t(e)}},required:r,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[_.jsx("option",{value:"",children:a}),h.map((e=>_.jsxs("option",{value:e.id,children:[e.name," - ",e.address]},e.id)))]})]}),e&&_.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:(()=>{const t=n.find((t=>t.id===e));return t?_.jsxs("div",{className:"space-y-2",children:[_.jsx("h4",{className:"font-medium text-gray-900",children:t.name}),_.jsx("p",{className:"text-sm text-gray-600",children:t.address}),t.phone&&_.jsxs("p",{className:"text-sm text-gray-600",children:["📞 ",t.phone]}),t.openingHours&&_.jsxs("p",{className:"text-sm text-gray-600",children:["🕒 ",t.openingHours]}),t.facilities&&t.facilities.length>0&&_.jsx("div",{className:"flex flex-wrap gap-1",children:t.facilities.map(((e,t)=>_.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded",children:e},t)))})]}):null})()}),0===h.length&&!g&&_.jsx("div",{className:"text-center py-4 text-gray-500",children:"没有找到符合条件的岩馆"})]})},is=({label:e,name:t,type:s="text",error:a,...r})=>_.jsxs("div",{className:"mb-4",children:[_.jsx("label",{htmlFor:t,className:"block text-sm font-medium text-gray-700 mb-1",children:e}),_.jsx("input",{id:t,name:t,type:s,...r,className:`block w-full px-3 py-2 border ${a?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm`}),a&&_.jsx("p",{className:"mt-1 text-xs text-red-500",children:a})]}),ls=({label:e,name:t,error:s,showCount:a,maxLength:r,value:n,...i})=>_.jsxs("div",{className:"mb-4",children:[_.jsx("label",{htmlFor:t,className:"block text-sm font-medium text-gray-700 mb-1",children:e}),_.jsx("textarea",{id:t,name:t,...i,value:n,maxLength:r,className:`block w-full px-3 py-2 border ${s?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm`}),s&&_.jsx("p",{className:"mt-1 text-xs text-red-500",children:s}),a&&r&&_.jsxs("p",{className:"mt-1 text-xs text-gray-500 text-right",children:[String(n)?.length||0," / ",r]})]}),os=({visible:e,onClose:t})=>{const{user:s}=nt(),{updateUserProfile:a}=ot(),[r,n]=u.useState({nickname:"",city:"",climbingAge:0,introduction:"",climbingPreferences:[],frequentlyVisitedGyms:"",gearTags:[]}),[l,o]=u.useState({}),d=[{label:"抱石",value:Oe.BOULDERING},{label:"运动攀岩",value:Oe.LEAD_CLIMBING},{label:"传统攀岩",value:Oe.TOP_ROPE_MANUAL_BELAY},{label:"室内",value:Oe.TOP_ROPE_AUTO_BELAY},{label:"室外",value:Oe.OUTDOOR}],m=[{label:"快挂",value:$e.QUICKDRAWS},{label:"绳索",value:$e.ROPE},{label:"安全带",value:$e.HARNESS},{label:"下降器",value:$e.BELAY_DEVICE},{label:"攀岩鞋",value:$e.SHOES},{label:"头盔",value:$e.HELMET}];u.useEffect((()=>{s&&e&&(n({nickname:s.nickname||"",city:s.city||"",climbingAge:void 0!==s.climbingAge?s.climbingAge:0,introduction:s.introduction||"",climbingPreferences:s.climbingPreferences||[],frequentlyVisitedGyms:Array.isArray(s.frequentlyVisitedGyms)?s.frequentlyVisitedGyms.join(", "):s.frequentlyVisitedGyms||"",gearTags:s.gearTags||[]}),o({}))}),[s,e]);const h=e=>{const{name:t,value:s}=e.target;n((e=>({...e,[t]:s}))),l[t]&&o((e=>({...e,[t]:void 0})))};return e?_.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:_.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[_.jsxs("div",{className:"flex justify-between items-center mb-4",children:[_.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"编辑个人信息"}),_.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 text-2xl",children:"×"})]}),_.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!s||!(()=>{const e={},t=r.nickname?.trim();return t?t.length<Re?e.nickname=`昵称至少${Re}个字符`:t.length>Be&&(e.nickname=`昵称最多${Be}个字符`):e.nickname="昵称不能为空",o(e),0===Object.keys(e).length})())return;const n={...r,climbingAge:Number(r.climbingAge),frequentlyVisitedGyms:r.frequentlyVisitedGyms?r.frequentlyVisitedGyms.split(",").map((e=>e.trim())).filter((e=>e)):[]};try{a(n),c("个人信息更新成功"),t()}catch(l){i(Ie)}},children:[_.jsx(is,{label:"昵称",name:"nickname",value:r.nickname,onChange:h,placeholder:"请输入昵称",error:l.nickname,required:!0}),_.jsx(is,{label:"城市",name:"city",value:r.city,onChange:h,placeholder:"请输入城市"}),_.jsx(is,{label:"岩龄 (年)",name:"climbingAge",type:"number",value:void 0===r.climbingAge?"":String(r.climbingAge),onChange:e=>((e,t)=>{const s=Number(t);n((t=>({...t,[e]:Math.max(0,s)}))),l[e]&&o((t=>({...t,[e]:void 0})))})("climbingAge",e.target.value),min:"0"}),_.jsx(ls,{label:"简介",name:"introduction",value:r.introduction,onChange:h,placeholder:"介绍一下自己吧",rows:3,maxLength:100,showCount:!0}),_.jsxs("div",{className:"mb-4",children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"攀爬偏好"}),_.jsx("div",{className:"space-y-2",children:d.map((e=>_.jsxs("label",{className:"flex items-center",children:[_.jsx("input",{type:"checkbox",checked:r.climbingPreferences?.includes(e.value)||!1,onChange:t=>{const s=t.target.checked?[...r.climbingPreferences||[],e.value]:(r.climbingPreferences||[]).filter((t=>t!==e.value));n((e=>({...e,climbingPreferences:s})))},className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),_.jsx("span",{className:"ml-2 text-sm text-gray-700",children:e.label})]},e.value)))})]}),_.jsx(is,{label:"常去的岩馆 (用逗号分隔)",name:"frequentlyVisitedGyms",value:r.frequentlyVisitedGyms,onChange:h,placeholder:"例如：岩馆A, 岩馆B"}),_.jsxs("div",{className:"mb-4",children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"我的装备"}),_.jsx("div",{className:"space-y-2",children:m.map((e=>_.jsxs("label",{className:"flex items-center",children:[_.jsx("input",{type:"checkbox",checked:r.gearTags?.includes(e.value)||!1,onChange:t=>{const s=t.target.checked?[...r.gearTags||[],e.value]:(r.gearTags||[]).filter((t=>t!==e.value));n((e=>({...e,gearTags:s})))},className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),_.jsx("span",{className:"ml-2 text-sm text-gray-700",children:e.label})]},e.value)))})]}),_.jsx("button",{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 transition duration-150 ease-in-out",children:"保存"})]})]})}):null},cs=({checked:e,onChange:t,labelId:s})=>_.jsx("button",{type:"button",role:"switch","aria-checked":e,"aria-labelledby":s,onClick:()=>{t(!e)},className:"relative inline-flex items-center h-6 rounded-full w-11 transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 "+(e?"bg-indigo-600":"bg-gray-300"),children:_.jsx("span",{className:"inline-block w-4 h-4 transform bg-white rounded-full transition-transform duration-200 ease-in-out "+(e?"translate-x-6":"translate-x-1")})}),ds=()=>{const{user:e}=nt(),{updateUserNotificationPreferences:t}=ot(),s=e?.notificationPreferences||De,a=(s,a)=>{e&&(t({[s]:a}),c("偏好已更新"))};return e?_.jsx("div",{className:"notification-preferences-section",children:_.jsx("div",{className:"space-y-3",children:[{id:"receiveActivityJoinNotifications",label:"有人报名我的活动"},{id:"receiveNewCommentNotifications",label:"我的活动有新留言"},{id:"receiveActivityUpdateNotifications",label:"我参与的活动有更新"},{id:"receiveSystemAnnouncements",label:"系统公告和重要通知"}].map(((e,t)=>_.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-md shadow-sm "+(t>0?"mt-2":""),children:[_.jsx("label",{htmlFor:`switch-${e.id}`,className:"text-sm text-gray-700 flex-grow mr-4 cursor-pointer",onClick:()=>a(e.id,!s[e.id]),children:e.label}),_.jsx(cs,{checked:s[e.id],onChange:t=>a(e.id,t),labelId:`switch-label-${e.id}`}),_.jsx("span",{id:`switch-label-${e.id}`,className:"sr-only",children:e.label})]},e.id)))})}):_.jsx("div",{className:"p-4 text-sm text-gray-500",children:"无法加载通知偏好设置。"})};u.createContext(null);const us=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const{login:e,register:t,isLoading:s}=function(e=!1){const t=m(),s=h(),{user:a,isAuthenticated:r,isLoading:n}=nt(),{setUser:l,logout:o,setUserLoading:d}=ot();return u.useEffect((()=>{(async()=>{try{if(a||n||!gt.isAuthenticated())a||gt.isAuthenticated()||await o();else{d(!0);try{const e=await gt.getProfile();l(e)}catch(b){await o()}finally{d(!1)}}}catch(b){await o()}})()}),[a,r,n,l,o,d]),u.useEffect((()=>{if(e&&!r&&!n){const e=`${s.pathname}${s.search}`;t("/login",{state:{from:e},replace:!0})}}),[e,r,n,t,s]),{user:a,isAuthenticated:r,isLoading:n,login:async(e,a)=>{try{d(!0);const r={phone:e,password:a},n=await gt.login(r);l(n.user),c("登录成功！");const i=s.state?.from||"/";return t(i,{replace:!0}),!0}catch(b){return b instanceof qe?401===b.status?i("手机号或密码错误"):i(b.message||Ie):i(Ie),!1}finally{d(!1)}},register:async(e,s,a,r)=>{try{d(!0);const n={phone:e,password:s,nickname:a,verificationCode:r},i=await gt.register(n);return l(i.user),c("注册成功！"),t("/",{replace:!0}),!0}catch(b){return b instanceof qe?409===b.status?i("该手机号已被注册"):400===b.status?i("验证码错误或已过期"):i(b.message||Ie):i(Ie),!1}finally{d(!1)}},logout:async()=>{try{d(!0),await gt.logout(),await o(),c("已退出登录"),t("/login",{replace:!0})}catch(b){await o(),t("/login",{replace:!0})}finally{d(!1)}},hasRole:e=>a?.role===e,hasAnyRole:e=>e.includes(a?.role||"")}}(),[a,l]=u.useState(!1),[o,d]=u.useState(""),[p,g]=u.useState(""),[x,f]=u.useState(""),[y,v]=u.useState(""),[b,j]=u.useState(null),N=u.useCallback((e=>e.trim()?/^1[3-9]\d{9}$/.test(e.trim())?null:"请输入有效的手机号":"请输入手机号"),[]),w=u.useCallback((e=>e?e.length<6?"密码至少6位":null:"请输入密码"),[]),k=u.useCallback((e=>{const t=e.trim();return t?t.length<Re?`昵称至少${Re}个字符`:t.length>Be?`昵称最多${Be}个字符`:null:"请输入昵称"}),[]),A=u.useCallback((e=>e.trim()?6!==e.trim().length?"验证码为6位数字":null:"请输入验证码"),[]),S=u.useCallback(((e,t)=>{switch(e){case"phone":d(t);break;case"password":g(t);break;case"nickname":f(t);break;case"verificationCode":v(t)}b&&j(null)}),[b]),C=u.useCallback((async s=>{s.preventDefault();let r=null;if(r=a?N(o)||w(p)||k(x)||A(y):N(o)||w(p),r)return j(r),void i(r);j(null);try{a?await t(o,p,x,y)&&c("注册成功！"):await e(o,p)&&c("登录成功！")}catch(n){}}),[o,p,x,y,a,e,t,N,w,k,A]),E=u.useCallback((()=>{l(!a),j(null),d(""),g(""),f(""),v("")}),[a]),L=u.useCallback((async()=>{const e=N(o);if(e)return j(e),void i(e);try{c("验证码已发送到您的手机")}catch(t){i("发送验证码失败，请重试")}}),[o,N]);return _.jsx("div",{className:"min-h-screen flex items-center justify-center p-6",style:{background:`linear-gradient(135deg, ${n.primary[50]} 0%, ${n.secondary[50]} 30%, ${n.primary[100]} 70%, ${n.secondary[100]} 100%)`},children:_.jsxs("div",{className:"w-full max-w-md p-8 rounded-3xl backdrop-blur-lg",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.85) 100%)",boxShadow:`${r.large}, inset 0 1px 0 rgba(255, 255, 255, 0.8)`,border:"1px solid rgba(255, 255, 255, 0.3)"},children:[_.jsxs("div",{className:"text-center mb-8",children:[_.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-2xl mb-4 text-4xl",style:{background:`linear-gradient(135deg, ${n.primary[500]} 0%, ${n.secondary[600]} 100%)`,boxShadow:r.medium},children:"🧗‍♀️"}),_.jsx("h1",{className:"text-4xl font-bold mb-2 bg-gradient-to-r bg-clip-text text-transparent",style:{backgroundImage:`linear-gradient(135deg, ${n.primary[600]} 0%, ${n.secondary[600]} 100%)`},children:"ClimberDaz"}),_.jsx("p",{className:"text-lg font-medium",style:{color:n.neutral[600]},children:"🏔️ 找到你的攀岩搭子"})]}),_.jsxs("form",{onSubmit:C,className:"space-y-6",noValidate:!0,children:[_.jsxs("div",{children:[_.jsx("label",{htmlFor:"phone",className:"block text-sm font-semibold mb-2",style:{color:n.neutral[700]},children:"手机号"}),_.jsx("input",{type:"tel",id:"phone",name:"phone",placeholder:"请输入手机号",disabled:s,value:o,onChange:e=>S("phone",e.target.value),className:"w-full px-4 py-4 text-lg font-medium rounded-2xl transition-all duration-300 ease-smooth focus:outline-none focus:ring-4 placeholder-neutral-400",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%)",border:b?`2px solid ${n.error.primary}`:`2px solid ${n.neutral[200]}`,backdropFilter:"blur(10px)",boxShadow:r.soft}})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"password",className:"block text-sm font-semibold mb-2",style:{color:n.neutral[700]},children:"密码"}),_.jsx("input",{type:"password",id:"password",name:"password",placeholder:"请输入密码",disabled:s,value:p,onChange:e=>S("password",e.target.value),className:"w-full px-4 py-4 text-lg font-medium rounded-2xl transition-all duration-300 ease-smooth focus:outline-none focus:ring-4 placeholder-neutral-400",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%)",border:b?`2px solid ${n.error.primary}`:`2px solid ${n.neutral[200]}`,backdropFilter:"blur(10px)",boxShadow:r.soft}})]}),a&&_.jsxs(_.Fragment,{children:[_.jsxs("div",{children:[_.jsx("label",{htmlFor:"nickname",className:"block text-sm font-semibold mb-2",style:{color:n.neutral[700]},children:"攀岩昵称"}),_.jsx("input",{type:"text",id:"nickname",name:"nickname",placeholder:"输入你的攀岩昵称",disabled:s,value:x,onChange:e=>S("nickname",e.target.value),maxLength:Be,className:"w-full px-4 py-4 text-lg font-medium rounded-2xl transition-all duration-300 ease-smooth focus:outline-none focus:ring-4 placeholder-neutral-400",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%)",border:b?`2px solid ${n.error.primary}`:`2px solid ${n.neutral[200]}`,backdropFilter:"blur(10px)",boxShadow:r.soft}})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"verificationCode",className:"block text-sm font-semibold mb-2",style:{color:n.neutral[700]},children:"验证码"}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx("input",{type:"text",id:"verificationCode",name:"verificationCode",placeholder:"6位验证码",disabled:s,value:y,onChange:e=>S("verificationCode",e.target.value),maxLength:6,className:"flex-1 px-4 py-4 text-lg font-medium rounded-2xl transition-all duration-300 ease-smooth focus:outline-none focus:ring-4 placeholder-neutral-400",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%)",border:b?`2px solid ${n.error.primary}`:`2px solid ${n.neutral[200]}`,backdropFilter:"blur(10px)",boxShadow:r.soft}}),_.jsx("button",{type:"button",onClick:L,disabled:s||!o,className:"px-4 py-2 text-sm font-bold text-white rounded-xl transition-all duration-300",style:{background:`linear-gradient(135deg, ${n.primary[500]} 0%, ${n.secondary[600]} 100%)`,boxShadow:r.soft},children:"发送验证码"})]})]})]}),b&&_.jsxs("p",{className:"text-sm font-medium flex items-center gap-2",style:{color:n.error.primary},role:"alert",children:[_.jsx("span",{children:"⚠️"}),b]}),_.jsx("button",{type:"submit",disabled:s||!o.trim()||!p.trim(),className:"w-full py-4 px-6 text-lg font-bold text-white rounded-2xl transition-all duration-300 ease-smooth hover:scale-[1.02] active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-4",style:{background:!s&&o.trim()&&p.trim()?`linear-gradient(135deg, ${n.primary[500]} 0%, ${n.secondary[600]} 100%)`:`linear-gradient(135deg, ${n.neutral[400]} 0%, ${n.neutral[500]} 100%)`,boxShadow:!s&&o.trim()&&p.trim()?r.medium:r.soft},children:s?_.jsxs("div",{className:"flex items-center justify-center gap-3",children:[_.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),_.jsx("span",{children:a?"注册中...":"登录中..."})]}):_.jsx("span",{className:"flex items-center justify-center gap-2",children:_.jsx("span",{children:a?"🎯 注册":"🚀 登录"})})}),_.jsx("div",{className:"text-center",children:_.jsx("button",{type:"button",onClick:E,className:"text-sm font-medium underline transition-colors duration-300",style:{color:n.primary[600]},children:a?"已有账号？点击登录":"没有账号？点击注册"})})]})]})})}},Symbol.toStringTag,{value:"Module"})),ms=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const e=m(),{user:t}=nt(),{logout:s}=ot(),{activities:a}=it(),[l,o]=u.useState(!1),d=a.filter((e=>e.hostId===t?.openid)),h=a.filter((e=>e.participantIds?.includes(t?.openid||"")));return t?_.jsxs("div",{className:"min-h-screen pb-20",style:{background:"linear-gradient(180deg, rgba(248, 250, 252, 0.9) 0%, rgba(241, 245, 249, 0.8) 100%)"},children:[_.jsxs("div",{className:"p-6 space-y-6",children:[_.jsxs("div",{className:"rounded-2xl p-8 backdrop-blur-sm border border-white/50",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%)",boxShadow:r.large},children:[_.jsxs("div",{className:"text-center",children:[_.jsx("div",{className:"flex items-center space-x-4 mt-2",children:_.jsx(ft,{avatar:t.avatar,nickname:t.nickname,level:t.level,size:88})}),_.jsxs("div",{className:"text-center mt-4",children:[_.jsxs("h1",{className:"text-2xl font-bold tracking-tight",style:{background:`linear-gradient(135deg, ${n.primary[600]} 0%, ${n.secondary[600]} 100%)`,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:["🏔️ ",t.nickname]}),t.level&&_.jsx("div",{className:"flex items-center mt-2",children:_.jsxs("span",{className:"px-4 py-2 rounded-xl text-sm font-semibold backdrop-blur-sm",style:{background:`linear-gradient(135deg, ${n.warning.primary}20 0%, ${n.warning.secondary}20 100%)`,color:n.warning.primary,border:`1px solid ${n.warning.primary}30`},children:["⭐ Lv.",t.level," 攀岩达人"]})}),_.jsxs("div",{className:"flex items-center space-x-4 mt-3 text-sm font-medium",style:{color:n.neutral[600]},children:[t.city&&_.jsxs("span",{className:"flex items-center gap-1",children:[_.jsx("span",{children:"📍"}),t.city]}),void 0!==t.climbingAge&&_.jsxs("span",{className:"flex items-center gap-1",children:[_.jsx("span",{children:"🕒"}),t.climbingAge,"年岩龄"]})]})]})]}),t.introduction&&_.jsx("div",{className:"mt-4 pt-4 rounded-xl p-4",style:{background:"rgba(255, 255, 255, 0.4)",border:"1px solid rgba(255, 255, 255, 0.6)"},children:_.jsxs("p",{className:"text-sm font-medium leading-relaxed",style:{color:n.neutral[700]},children:["💭 ",t.introduction]})}),_.jsxs("div",{className:"flex gap-3 mt-6",children:[_.jsx("button",{onClick:()=>o(!0),className:"flex-1 py-3 px-6 rounded-xl font-semibold text-sm transition-all duration-300 hover:scale-105",style:{background:`linear-gradient(135deg, ${n.primary[500]} 0%, ${n.primary[600]} 100%)`,color:"white",boxShadow:r.medium},children:"✏️ 编辑资料"}),_.jsx("button",{onClick:async()=>{if(window.confirm("确定要退出登录吗？"))try{await s(),e("/login"),c("退出登录成功")}catch(t){i("退出登录失败，请重试")}},className:"py-3 px-6 rounded-xl font-semibold text-sm transition-all duration-300 hover:scale-105",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%)",color:n.error.primary,border:`1px solid ${n.error.primary}30`,boxShadow:r.soft},children:"🚪 退出登录"})]})]}),t.climbingPreferences&&t.climbingPreferences.length>0||t.frequentlyVisitedGyms&&t.frequentlyVisitedGyms.length>0||t.gearTags&&t.gearTags.length>0?_.jsxs("div",{className:"rounded-2xl backdrop-blur-sm overflow-hidden",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%)",boxShadow:r.large,border:"1px solid rgba(255, 255, 255, 0.5)"},children:[_.jsx("div",{className:"p-6 border-b",style:{borderColor:"rgba(255, 255, 255, 0.5)"},children:_.jsx("h3",{className:"text-lg font-bold",style:{color:n.neutral[800]},children:"🧗‍♀️ 攀岩信息"})}),_.jsxs("div",{className:"divide-y",style:{borderColor:"rgba(255, 255, 255, 0.5)"},children:[t.climbingPreferences&&t.climbingPreferences.length>0&&_.jsxs("div",{className:"p-6 flex gap-4",children:[_.jsx("span",{className:"w-20 text-sm font-bold",style:{color:n.neutral[600]},children:"偏好类型"}),_.jsx("div",{className:"flex-1",children:_.jsx("div",{className:"flex flex-wrap gap-2",children:t.climbingPreferences.map(((e,t)=>_.jsx("span",{className:"px-3 py-1.5 rounded-xl text-xs font-semibold backdrop-blur-sm",style:{background:`linear-gradient(135deg, ${n.secondary[500]}20 0%, ${n.secondary[600]}20 100%)`,color:n.secondary[600],border:`1px solid ${n.secondary[500]}30`},children:e},t)))})})]}),t.frequentlyVisitedGyms&&t.frequentlyVisitedGyms.length>0&&_.jsxs("div",{className:"p-6 flex gap-4",children:[_.jsx("span",{className:"w-20 text-sm font-bold",style:{color:n.neutral[600]},children:"常去岩馆"}),_.jsx("div",{className:"flex-1",children:_.jsx("div",{className:"flex flex-wrap gap-2",children:t.frequentlyVisitedGyms.map(((e,t)=>_.jsxs("span",{className:"px-3 py-1.5 rounded-xl text-xs font-semibold backdrop-blur-sm",style:{background:`linear-gradient(135deg, ${n.primary[500]}20 0%, ${n.primary[600]}20 100%)`,color:n.primary[600],border:`1px solid ${n.primary[500]}30`},children:["🏢 ",e]},t)))})})]}),t.gearTags&&t.gearTags.length>0&&_.jsxs("div",{className:"p-6 flex gap-4",children:[_.jsx("span",{className:"w-20 text-sm font-bold",style:{color:n.neutral[600]},children:"装备标签"}),_.jsx("div",{className:"flex-1",children:_.jsx("div",{className:"flex flex-wrap gap-2",children:t.gearTags.map(((e,t)=>_.jsxs("span",{className:"px-3 py-1.5 rounded-xl text-xs font-semibold backdrop-blur-sm",style:{background:`linear-gradient(135deg, ${n.warning.primary}20 0%, ${n.warning.secondary}20 100%)`,color:n.warning.primary,border:`1px solid ${n.warning.primary}30`},children:["🎯 ",e]},t)))})})]})]})]}):null,_.jsxs("div",{className:"rounded-2xl p-6 backdrop-blur-sm",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%)",boxShadow:r.large,border:"1px solid rgba(255, 255, 255, 0.5)"},children:[_.jsx("h3",{className:"text-lg font-bold mb-4",style:{color:n.neutral[800]},children:"📊 活动统计"}),_.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[_.jsxs("div",{className:"text-center",children:[_.jsx("div",{className:"text-2xl font-bold",style:{color:n.primary[600]},children:d.length}),_.jsx("div",{className:"text-sm",style:{color:n.neutral[600]},children:"发起的活动"})]}),_.jsxs("div",{className:"text-center",children:[_.jsx("div",{className:"text-2xl font-bold",style:{color:n.secondary[600]},children:h.length}),_.jsx("div",{className:"text-sm",style:{color:n.neutral[600]},children:"参与的活动"})]})]})]}),_.jsx(ds,{})]}),t&&_.jsx(os,{visible:l,onClose:()=>o(!1)})]}):_.jsx("div",{className:"flex items-center justify-center h-screen",style:{background:"linear-gradient(180deg, rgba(248, 250, 252, 0.9) 0%, rgba(241, 245, 249, 0.8) 100%)"},children:_.jsxs("div",{className:"text-center",children:[_.jsx("div",{className:"text-6xl mb-4",children:"👤"}),_.jsx("p",{className:"text-neutral-500",children:"加载用户信息中..."})]})})}},Symbol.toStringTag,{value:"Module"}));export{Oe as A,ts as B,Le as C,Te as D,Ct as E,qt as I,yt as L,Ce as M,ut as N,Wt as P,es as R,mt as S,ss as T,ft as U,S as _,D as a,De as b,ns as c,Me as d,ct as e,lt as f,dt as g,nt as h,as as i,_ as j,ot as k,At as l,Ht as m,xt as n,us as o,R as p,ms as q,Ot as r,it as u};
