import{a as e,R as r,j as a,U as s,S as t,V as l,E as o}from"./activity-SV2nIvCU.js";import{b as n,u as i,r as c}from"./router-vendor-Cs108294.js";import{s as d,c as u,f as m,b,e as x}from"./utils-BEM4FbqU.js";import"./react-vendor-BRaCMJ4j.js";import"./state-vendor-DHqOUJve.js";const g="Alice",p="https://api.dicebear.com/7.x/avataaars/svg?seed=Alice",h=()=>a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-6 h-6",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})}),y=({title:e,onBack:r})=>a.jsx("div",{className:"sticky top-0 z-10 mb-6 backdrop-blur-lg",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.85) 100%)",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:d.medium},children:a.jsx("div",{className:"px-6 py-4",children:a.jsxs("div",{className:"relative flex items-center justify-center",children:[r&&a.jsx("button",{onClick:r,className:"absolute left-0 p-2 rounded-xl transition-all duration-200 hover:scale-110 active:scale-95",style:{background:`linear-gradient(135deg, ${u.neutral[100]} 0%, ${u.neutral[200]} 100%)`,color:u.primary[600]},children:a.jsx(h,{})}),a.jsxs("h1",{className:"text-xl font-bold bg-gradient-to-r bg-clip-text text-transparent",style:{backgroundImage:`linear-gradient(135deg, ${u.primary[600]} 0%, ${u.secondary[600]} 100%)`},children:["⭐ ",e]})]})})}),j=({label:e,name:r,helpText:s,showCount:t,maxLength:l,value:o,error:n,...i})=>{var c;return a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{htmlFor:r,className:"block text-sm font-semibold mb-2",style:{color:u.neutral[700]},children:e}),s&&a.jsx("p",{className:"text-xs mb-2",style:{color:u.neutral[500]},children:s}),a.jsx("textarea",{id:r,name:r,value:o,maxLength:l,...i,className:"block w-full px-4 py-3 text-sm font-medium rounded-2xl transition-all duration-300 ease-smooth focus:outline-none focus:ring-4 backdrop-blur-sm",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%)",border:n?`2px solid ${u.error.primary}`:`2px solid ${u.neutral[200]}`,backdropFilter:"blur(10px)",boxShadow:d.soft},onFocus:e=>{e.target.style.borderColor=n?u.error.primary:u.primary[400],e.target.style.boxShadow=n?`0 0 0 4px ${u.error.subtle}`:`0 0 0 4px ${u.primary[100]}`},onBlur:e=>{e.target.style.borderColor=n?u.error.primary:u.neutral[200],e.target.style.boxShadow=d.soft}}),a.jsxs("div",{className:"flex justify-between items-center",children:[n&&a.jsxs("p",{className:"mt-2 text-xs font-medium flex items-center gap-1",style:{color:u.error.primary},children:[a.jsx("span",{children:"⚠️"}),n]}),t&&l&&a.jsxs("p",{className:"mt-2 text-xs font-medium ml-auto ",style:{color:n?u.error.primary:u.neutral[500]},children:[(null==(c=String(o))?void 0:c.length)||0," / ",l]})]})]})},v=()=>{const{activityId:h}=n(),v=i(),{user:f}=e(),[w,k]=c.useState(""),[N,$]=c.useState(null),[S,C]=c.useState(!1),[E,T]=c.useState({}),M=async e=>{if(e.preventDefault(),(()=>{const e={};return N||(e.status="请选择一个评价状态"),w.length>l.COMMENT.MAX_LENGTH&&(e.comment=`评价内容不能超过${l.COMMENT.MAX_LENGTH}字`),T(e),0===Object.keys(e).length})()){if(!f)return b(o.UNAUTHORIZED),void v("/login");C(!0);try{await new Promise((e=>setTimeout(e,1500))),x(t.REVIEW_SUBMITTED),v(`/activity/${h}`)}catch(r){b(o.SERVER_ERROR)}finally{C(!1)}}else N||m("请选择一个评价状态")},O=[{label:"👍 表现很好",value:r.GOOD,type:"success"},{label:"👎 有待改进",value:r.BAD,type:"error"},{label:"😕 未到场",value:r.NO_SHOW,type:"warning"}],L=(e,r)=>{if(r)switch(e){case"success":return{background:`linear-gradient(135deg, ${u.success.primary} 0%, ${u.success.secondary} 100%)`,color:"white",border:`2px solid ${u.success.primary}`};case"error":return{background:`linear-gradient(135deg, ${u.error.primary} 0%, ${u.error.secondary} 100%)`,color:"white",border:`2px solid ${u.error.primary}`};case"warning":return{background:`linear-gradient(135deg, ${u.warning.primary} 0%, ${u.warning.secondary} 100%)`,color:"white",border:`2px solid ${u.warning.primary}`}}else switch(e){case"success":return{background:`linear-gradient(135deg, ${u.success.subtle} 0%, rgba(255, 255, 255, 0.8) 100%)`,color:u.success.primary,border:`2px solid ${u.success.soft}`};case"error":return{background:`linear-gradient(135deg, ${u.error.subtle} 0%, rgba(255, 255, 255, 0.8) 100%)`,color:u.error.primary,border:`2px solid ${u.error.soft}`};case"warning":return{background:`linear-gradient(135deg, ${u.warning.subtle} 0%, rgba(255, 255, 255, 0.8) 100%)`,color:u.warning.primary,border:`2px solid ${u.warning.soft}`}}};return a.jsxs("div",{className:"min-h-screen",style:{background:"linear-gradient(180deg, rgba(248, 250, 252, 0.9) 0%, rgba(241, 245, 249, 0.8) 100%)"},children:[a.jsx(y,{title:"互评参与者",onBack:()=>v(-1)}),a.jsxs("div",{className:"px-6 space-y-6",children:[a.jsx("div",{className:"p-6 rounded-2xl backdrop-blur-sm",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%)",boxShadow:d.card,border:"1px solid rgba(255, 255, 255, 0.3)"},children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(s,{avatar:p,nickname:g,size:64}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold mb-1",style:{color:u.neutral[800]},children:g}),a.jsx("p",{className:"text-sm font-medium",style:{color:u.neutral[600]},children:"🎯 对本次活动的参与情况做出评价"})]})]})}),a.jsxs("div",{className:"p-6 rounded-2xl backdrop-blur-sm",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%)",boxShadow:d.card,border:"1px solid rgba(255, 255, 255, 0.3)"},children:[a.jsx("h3",{className:"text-lg font-bold text-center mb-4",style:{color:u.neutral[700]},children:"⭐ 选择评价状态"}),E.status&&a.jsxs("p",{className:"text-sm font-medium text-center mb-4 flex items-center justify-center gap-2",style:{color:u.error.primary},children:[a.jsx("span",{children:"⚠️"}),E.status]}),a.jsx("div",{className:"space-y-3",children:O.map((e=>{const r=N===e.value;return a.jsx("button",{type:"button",onClick:()=>{$(e.value),T((e=>({...e,status:void 0})))},className:"w-full py-4 px-6 text-sm font-bold rounded-2xl transition-all duration-300 ease-smooth hover:scale-[1.02] active:scale-95 backdrop-blur-sm",style:L(e.type,r),children:e.label},e.value)}))})]}),a.jsx("div",{className:"p-6 rounded-2xl backdrop-blur-sm",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%)",boxShadow:d.card,border:"1px solid rgba(255, 255, 255, 0.3)"},children:a.jsx("form",{onSubmit:M,children:a.jsx(j,{label:"💬 补充说明 (选填)",name:"comment",placeholder:"分享更多细节，你的评价对其他岩友很有帮助...",rows:4,maxLength:80,showCount:!0,value:w,onChange:e=>k(e.target.value),helpText:"例如：守时情况、技术水平、团队合作、安全意识等方面的表现。",error:E.comment})})}),a.jsxs("div",{className:"space-y-4 pb-8",children:[a.jsxs("button",{type:"submit",onClick:M,disabled:S||!N,className:"w-full py-4 px-6 text-lg font-bold text-white rounded-2xl transition-all duration-300 ease-smooth hover:scale-[1.02] active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3",style:{background:S||!N?`linear-gradient(135deg, ${u.neutral[400]} 0%, ${u.neutral[500]} 100%)`:`linear-gradient(135deg, ${u.primary[500]} 0%, ${u.secondary[600]} 100%)`,boxShadow:S||!N?d.soft:d.medium},children:[S&&a.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),S?"⏳ 提交中...":"🚀 提交评价"]}),a.jsx("button",{type:"button",onClick:async()=>{window.confirm("确定要跳过评价吗？跳过后将无法再次评价。")&&v(-1)},disabled:S,className:"w-full py-4 px-6 text-lg font-bold rounded-2xl transition-all duration-300 ease-smooth hover:scale-[1.02] active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed backdrop-blur-sm",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.8) 0%, rgba(255, 255, 255, 0.6) 100%)",color:u.neutral[600],border:`2px solid ${u.neutral[300]}`},children:"⏭️ 以后再说 (跳过)"})]}),a.jsxs("div",{className:"p-6 rounded-2xl text-center backdrop-blur-sm",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.6) 0%, rgba(255, 255, 255, 0.4) 100%)",border:"1px solid rgba(255, 255, 255, 0.3)"},children:[a.jsx("p",{className:"text-sm font-medium mb-2",style:{color:u.neutral[600]},children:"💡 温馨提示"}),a.jsx("p",{className:"text-xs mb-1",style:{color:u.neutral[500]},children:"评价提交后不可修改"}),a.jsx("p",{className:"text-xs",style:{color:u.neutral[500]},children:"您的评价将帮助我们维护友好的攀岩社区环境 🏔️"})]})]})]})};export{v as default};
