import{D as e,A as a,M as s,C as t,j as r,d as l,L as i,U as n,a as o,p as c,b as d,c as m,u,e as x,f as h,g,I as p,P as b,R as v,h as y}from"./auth-features-B9i09fKj.js";import{r as j,u as f,R as N,b as w}from"./router-DIp0qzM7.js";import{h as k,c as A,s as L,d as C,g as M}from"./utils-C8L9ZeeV.js";import{a as $}from"./state-Dl9MXZu6.js";import{B as T}from"./notifications-DK5Y3Ipx.js";const _=[{label:"V0-V2",value:e.V0_V2,min:"V0",max:"V2",order:0},{label:"V3-V5",value:e.V3_V5,min:"V3",max:"V5",order:1},{label:"V6-V7",value:e.V6_V7,min:"V6",max:"V7",order:2},{label:"V8+",value:e.V8_PLUS,min:"V8",max:"V8+",order:3},{label:"V-Open (不限)",value:e.V_OPEN,min:"V-Open",max:"V-Open",order:4}],S=[{label:"5.5-5.8",value:e.YDS_5_5_5_8,min:"5.5",max:"5.8",order:0},{label:"5.9-5.10d",value:e.YDS_5_9_5_10D,min:"5.9",max:"5.10d",order:1},{label:"5.11a-5.11d",value:e.YDS_5_11A_5_11D,min:"5.11a",max:"5.11d",order:2},{label:"5.12a-5.12d",value:e.YDS_5_12A_5_12D,min:"5.12a",max:"5.12d",order:3},{label:"5.13+",value:e.YDS_5_13_PLUS,min:"5.13",max:"5.13+",order:4},{label:"YDS-Open (不限)",value:e.YDS_OPEN,min:"YDS-Open",max:"YDS-Open",order:5}],O=_.map((({label:e,value:a})=>({label:e,value:a}))),D=S.map((({label:e,value:a})=>({label:e,value:a}))),E={[a.BOULDERING]:{label:"抱石",gradeSystem:"VScale",associatedGrades:O},[a.TOP_ROPE_AUTO_BELAY]:{label:"顶绳-自动保护",gradeSystem:"YDS",associatedGrades:D},[a.TOP_ROPE_MANUAL_BELAY]:{label:"顶绳-需保护",gradeSystem:"YDS",associatedGrades:D},[a.LEAD_CLIMBING]:{label:"先锋",gradeSystem:"YDS",associatedGrades:D},[a.OUTDOOR]:{label:"户外",gradeSystem:"Both",associatedGrades:[...O,...D]},[a.TRAINING]:{label:"训练",gradeSystem:"None",associatedGrades:[]}};Object.entries(E).map((([e,{label:a}])=>({label:a,value:e})));const P=e=>{if(!e||0===e.length)return[];const a=e.map((e=>_.find((a=>a.value===e))||S.find((a=>a.value===e)))).filter((e=>!!e));if(0===a.length)return[];const s=a.sort(((e,a)=>e.order-a.order)),t=[];let r=s[0].label,l=s[0].value.startsWith("V")?"VScale":"YDS";for(let n=1;n<s.length;n++){const e=s[n],a=s[n-1],i=e.value.startsWith("V")?"VScale":"YDS";e.order===a.order+1&&i===l||(r===a.label?t.push(r):t.push(`${r}-${a.label.split(" ")[0]}`),r=e.label,l=i)}const i=s[s.length-1];return r===i.label?t.push(r):t.push(`${r}-${i.label.split(" ")[0]}`),t},I={[a.BOULDERING]:{text:"抱石",emoji:"🧗",color:k.BOULDERING.color,bgColor:k.BOULDERING.bgColor,borderColor:k.BOULDERING.borderColor},[a.TOP_ROPE_AUTO_BELAY]:{text:"顶绳(自动)",emoji:"🔗",color:k.TOP_ROPE_AUTO_BELAY.color,bgColor:k.TOP_ROPE_AUTO_BELAY.bgColor,borderColor:k.TOP_ROPE_AUTO_BELAY.borderColor},[a.TOP_ROPE_MANUAL_BELAY]:{text:"顶绳(手动)",emoji:"👥",color:k.TOP_ROPE_MANUAL_BELAY.color,bgColor:k.TOP_ROPE_MANUAL_BELAY.bgColor,borderColor:k.TOP_ROPE_MANUAL_BELAY.borderColor},[a.LEAD_CLIMBING]:{text:"先锋",emoji:"🧭",color:k.LEAD_CLIMBING.color,bgColor:k.LEAD_CLIMBING.bgColor,borderColor:k.LEAD_CLIMBING.borderColor},[a.OUTDOOR]:{text:"野外",emoji:"🏔️",color:k.OUTDOOR.color,bgColor:k.OUTDOOR.bgColor,borderColor:k.OUTDOOR.borderColor},[a.TRAINING]:{text:"训练",emoji:"💪",color:k.TRAINING.color,bgColor:k.TRAINING.bgColor,borderColor:k.TRAINING.borderColor}},B={[s.MEET_AT_ENTRANCE]:"门口集合",[s.FIRST_COME_FIRST_CLIMB]:"先到先攀"},R={[t.FREE]:{text:"免费",color:A.success.primary,bgColor:A.success.subtle},[t.HOST_TREAT]:{text:"发起人请客",color:A.warning.primary,bgColor:A.warning.subtle},[t.AA]:{text:"AA制",color:A.secondary[600],bgColor:A.secondary[50]}},G=j.memo((({variant:e="default",children:a,className:s="",style:t})=>r.jsx("span",{className:`\n        inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-semibold rounded-xl\n        border transition-all duration-300 ease-smooth\n        hover:scale-105 hover:shadow-lg\n        ${{default:"bg-white/80 text-neutral-700 border-neutral-200/50 backdrop-blur-sm",primary:"bg-gradient-to-r from-primary-500 to-primary-600 text-white border-primary-500 shadow-md",secondary:"bg-gradient-to-r from-secondary-500 to-secondary-600 text-white border-secondary-500 shadow-md",warning:"bg-gradient-to-r from-warning-400 to-warning-500 text-warning-900 border-warning-400 shadow-md",success:"bg-gradient-to-r from-green-500 to-green-600 text-white border-green-500 shadow-md","activity-type":"backdrop-blur-sm shadow-sm",gradient:"bg-gradient-to-r from-white/90 to-white/70 text-neutral-700 border-white/50 backdrop-blur-sm shadow-sm"}[e]} ${s}\n      `,style:t,children:a})));G.displayName="Tag";const U=j.memo((({activity:e,onClick:a,className:s="",showDistance:t=!1})=>{const o=j.useMemo((()=>({isActivityFull:(e.participantCount||0)>=e.slotMax,isActivityStarted:l(e.datetime).isBefore(l()),formattedDateTime:l(e.datetime).format("MM月DD日 HH:mm"),participantText:`${e.participantCount||0}/${e.slotMax}人`,distanceText:void 0!==e.distance&&null!==e.distance?`${e.distance.toFixed(1)}km`:null})),[e.participantCount,e.slotMax,e.datetime,e.distance]),c=j.useMemo((()=>e.types.map((e=>{const a=I[e];return r.jsxs(G,{variant:"activity-type",style:{background:`linear-gradient(135deg, ${a.bgColor} 0%, ${a.color}20 100%)`,color:a.color,borderColor:a.borderColor},children:[r.jsx("span",{className:"text-sm drop-shadow-sm",children:a.emoji}),r.jsx("span",{className:"font-semibold",children:a.text})]},e)}))),[e.types]),d=j.useMemo((()=>e.grades&&0!==e.grades.length?P(e.grades).map((e=>r.jsx(G,{variant:"primary",children:e},e))):null),[e.grades]),m=j.useMemo((()=>{const a=e.host?.avatar;return a?r.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 rounded-2xl overflow-hidden opacity-20 pointer-events-none",children:r.jsx(i,{src:a,alt:`${e.title} - 活动图片`,className:"w-full h-full object-cover",aspectRatio:1,enableBlur:!0,priority:!1})}):null}),[e.host?.avatar,e.title]),u=j.useMemo((()=>{const a=e.types.map((e=>I[e].text)).join("、"),s=e.grades?.length?P(e.grades).join("、"):"",t=o.formattedDateTime,r=e.host?.nickname||"未知用户";return`${e.title}，活动类型：${a}${s?`，难度：${s}`:""}，时间：${t}，地点：${e.locationText}，主办人：${r}，参与人数：${o.participantText}`}),[e.title,e.types,e.grades,e.locationText,e.host?.nickname,o.formattedDateTime,o.participantText]),x=e=>{e.stopPropagation()},h=R[e.costMode],g={background:`linear-gradient(135deg, ${A.primary[500]}15 0%, ${A.neutral[100]} 40%, ${A.neutral[50]} 100%)`,borderImage:`linear-gradient(135deg, ${A.primary[400]} 0%, ${A.neutral[300]} 100%) 1`};return r.jsxs("div",{className:`\n        group activity-card relative cursor-pointer overflow-hidden\n        transform transition-all duration-300 ease-smooth\n        hover:scale-[1.02] hover:shadow-xl\n        focus:scale-[1.02] focus:shadow-xl focus:outline-none focus:ring-2 focus:ring-primary-400\n        ${s}\n      `,style:{...g,border:`1px solid ${A.neutral[200]}40`,borderRadius:"20px",padding:"24px",marginBottom:"16px",boxShadow:L.card},onClick:()=>a?.(e),role:"button",tabIndex:0,"aria-label":u,onKeyDown:s=>{"Enter"!==s.key&&" "!==s.key||(s.preventDefault(),a?.(e))},children:[(o.isActivityFull||o.isActivityStarted)&&r.jsx("div",{className:"absolute top-4 right-4 px-3 py-1.5 rounded-xl text-xs font-bold backdrop-blur-sm z-20",style:{background:o.isActivityStarted?`linear-gradient(135deg, ${A.neutral[500]} 0%, ${A.neutral[500]} 100%)`:`linear-gradient(135deg, ${A.warning[500]} 0%, ${A.warning[500]} 100%)`,color:"white",boxShadow:L.soft},"aria-label":o.isActivityStarted?"活动已开始":"活动已满员",children:o.isActivityStarted?"已开始":"已满员"}),m,r.jsxs("div",{className:"mb-5 relative z-10",children:[r.jsx("h3",{className:"text-xl font-bold text-neutral-800 mb-3 pr-24 leading-tight drop-shadow-sm",children:e.title}),r.jsxs("div",{className:"flex flex-wrap gap-2.5 mb-4",role:"list","aria-label":"活动类型和难度",children:[c,d]})]}),r.jsxs("div",{className:"space-y-3 mb-5 relative z-10",children:[r.jsxs("div",{className:"flex items-center gap-3 text-neutral-700",children:[r.jsx("span",{className:"text-lg p-2 rounded-xl bg-white/70 backdrop-blur-sm shadow-sm",style:{color:A.primary[500]},"aria-hidden":"true",children:"📅"}),r.jsx("span",{className:"text-sm font-semibold",children:o.formattedDateTime})]}),r.jsxs("div",{className:"flex items-center gap-3 text-neutral-700",children:[r.jsx("span",{className:"text-lg p-2 rounded-xl bg-white/70 backdrop-blur-sm shadow-sm",style:{color:A.secondary[500]},"aria-hidden":"true",children:"📍"}),r.jsx("span",{className:"text-sm font-medium",children:e.locationText}),t&&o.distanceText&&r.jsx("span",{className:"text-xs text-neutral-600 bg-white/60 px-3 py-1 rounded-full backdrop-blur-sm shadow-sm","aria-label":`距离 ${o.distanceText}`,children:o.distanceText})]})]}),r.jsxs("div",{className:"flex items-center gap-3 mb-5 relative z-10 cursor-pointer hover:opacity-80 transition-opacity duration-200",onClick:x,role:"button",tabIndex:0,"aria-label":`主办人：${e.host?.nickname||"未知用户"}`,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),x(e))},children:[r.jsx(n,{avatar:e.host?.avatar,nickname:e.host?.nickname||"未知用户",level:e.host?.level,size:40,className:"shadow-lg"}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("p",{className:"text-sm font-semibold text-neutral-800 truncate",children:["主办：",e.host?.nickname||"未知用户"]}),r.jsxs("p",{className:"text-xs text-neutral-600",children:["等级：",e.host?.level||"未知"]})]}),r.jsxs("div",{className:"text-sm font-bold px-3 py-1.5 rounded-xl backdrop-blur-sm",style:{background:`linear-gradient(135deg, ${A.primary[100]} 0%, ${A.primary[50]} 100%)`,color:A.primary[600],border:`1px solid ${A.primary[200]}`},"aria-label":`参与人数：${o.participantText}`,children:["👥 ",o.participantText]})]}),r.jsxs("div",{className:"flex items-center justify-between pt-4 border-t relative z-10",style:{borderColor:`${A.neutral[200]}80`},children:[r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsxs(G,{variant:"activity-type",style:{background:`linear-gradient(135deg, ${h.bgColor} 0%, ${h.color}15 100%)`,color:h.color,borderColor:h.color+"40"},children:[r.jsx("span",{className:"text-xs","aria-hidden":"true",children:"💰"}),r.jsx("span",{className:"font-semibold",children:h.text})]}),r.jsx("span",{className:"text-xs text-neutral-600 font-medium bg-white/50 px-3 py-1 rounded-lg backdrop-blur-sm","aria-label":`见面方式：${B[e.meetMode]}`,children:B[e.meetMode]})]}),r.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-all duration-300 transform group-hover:translate-x-1","aria-hidden":"true",children:r.jsx("div",{className:"p-2 rounded-xl shadow-lg",style:{background:`linear-gradient(135deg, ${A.primary[500]} 0%, ${A.primary[600]} 100%)`},children:r.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M9 5l7 7-7 7"})})})})]}),r.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 opacity-5 pointer-events-none",style:{background:`radial-gradient(circle, ${A.primary[500]} 0%, transparent 70%)`},"aria-hidden":"true"}),r.jsx("div",{className:"absolute bottom-0 left-0 w-1 h-16 opacity-10 pointer-events-none",style:{background:`linear-gradient(to top, ${A.secondary[500]} 0%, transparent 100%)`},"aria-hidden":"true"})]})})),V=[{openid:"user1",nickname:"RockClimber",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=RockClimber",gearTags:["SHOES"],createdAt:new Date,role:"user",isBanned:!1,climbingAge:3,city:"北京",frequentlyVisitedGyms:["岩时攀岩馆（望京店）"],climbingPreferences:["BOULDERING"]},{openid:"user2",nickname:"NewbieClimber",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=NewbieClimber",gearTags:[],createdAt:new Date,role:"user",isBanned:!1,climbingAge:1,city:"上海"},{openid:"user3",nickname:"AdminUser",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=AdminUser",gearTags:[],createdAt:new Date,role:"admin",isBanned:!1},{openid:"user4",nickname:"BannedUserExample",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=BannedUserExample",gearTags:[],createdAt:new Date,role:"user",isBanned:!0}],z=$()(o(c((e=>({user:null,allUsers:V.map((e=>({...e,climbingAge:e.climbingAge,introduction:e.introduction,city:e.city,frequentlyVisitedGyms:e.frequentlyVisitedGyms||[],climbingPreferences:e.climbingPreferences||[],isBanned:e.isBanned||!1,role:e.role||"user",notificationPreferences:e.notificationPreferences||d}))),isAuthenticated:!1,isLoading:!1,setUser:a=>e({user:a?{...a,climbingAge:a.climbingAge,introduction:a.introduction,city:a.city,frequentlyVisitedGyms:a.frequentlyVisitedGyms||[],climbingPreferences:a.climbingPreferences||[],isBanned:a.isBanned||!1,role:a.role||"user",notificationPreferences:a.notificationPreferences||d}:null,isAuthenticated:!!a}),setAllUsers:a=>e({allUsers:a.map((e=>({...e,climbingAge:e.climbingAge,introduction:e.introduction,city:e.city,frequentlyVisitedGyms:e.frequentlyVisitedGyms||[],climbingPreferences:e.climbingPreferences||[],isBanned:e.isBanned||!1,role:e.role||"user",notificationPreferences:e.notificationPreferences||d})))}),setUserLoading:a=>e({isLoading:a}),updateUserStatus:(a,s)=>e((e=>({allUsers:e.allUsers.map((e=>e.openid===a?{...e,...s,updatedAt:new Date}:e)),user:e.user&&e.user.openid===a?{...e.user,...s,updatedAt:new Date}:e.user}))),updateUserPreferences:a=>e((e=>e.user?{user:{...e.user,notificationPreferences:{...e.user.notificationPreferences||d,...a},updatedAt:new Date}}:{})),updateUserProfile:a=>e((e=>{if(e.user){const s={...e.user,...a,updatedAt:new Date},t=e.allUsers.map((e=>e.openid===s.openid?s:e));return{user:s,allUsers:t}}return{}})),logout:()=>e({user:null,isAuthenticated:!1,isLoading:!1}),activities:[],currentActivity:null,activitiesLoading:!1,setActivities:a=>e({activities:a}),setCurrentActivity:a=>e({currentActivity:a}),setActivitiesLoading:a=>e({activitiesLoading:a}),addActivity:a=>e((e=>({activities:[a,...e.activities]}))),updateActivity:(a,s)=>e((e=>({activities:e.activities.map((e=>e.id===a?{...e,...s}:e))}))),removeActivity:a=>e((e=>({activities:e.activities.filter((e=>e.id!==a))}))),announcements:[],loading:!1,error:null,setAnnouncements:a=>e({announcements:a}),setLoading:a=>e({loading:a}),setError:a=>e({error:a}),activityListSearchText:"",activityListSelectedTypes:[],activityListSelectedGrades:[],setActivityListSearchText:a=>e({activityListSearchText:a}),setActivityListSelectedTypes:a=>e({activityListSelectedTypes:a}),setActivityListSelectedGrades:a=>e({activityListSelectedGrades:a}),resetActivityListFilters:()=>e({activityListSearchText:"",activityListSelectedTypes:[],activityListSelectedGrades:[]})})),{name:"climberdaz-storage",partialize:e=>({user:e.user,isAuthenticated:e.isAuthenticated,activityListSearchText:e.activityListSearchText,activityListSelectedTypes:e.activityListSelectedTypes,activityListSelectedGrades:e.activityListSelectedGrades}),version:2}),{name:"climberdaz-store"})),Y=()=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})}),F=()=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 10.5a3 3 0 11-6 0 3 3 0 016 0z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z"})]}),H=()=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),q=()=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 002.625.372 9.337 9.337 0 004.121-.952 4.125 4.125 0 00-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 018.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0111.964-3.07M12 6.375a3.375 3.375 0 11-6.75 0 3.375 3.375 0 016.75 0zm8.25 2.25a2.625 2.625 0 11-5.25 0 2.625 2.625 0 015.25 0z"})}),W=()=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z"}),r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 6h.008v.008H6V6z"})]}),K=()=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z"})}),J=()=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.894 20.567L16.5 21.75l-.394-1.183a2.25 2.25 0 00-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 001.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 001.423 1.423l1.183.394-1.183.394a2.25 2.25 0 00-1.423 1.423z"})}),Q=[{label:"岩时攀岩馆（望京店）",value:"yanhshi_wangjing",lat:39.9884,lng:116.4716},{label:"岩时攀岩馆（国贸店）",value:"yanhshi_guomao",lat:39.9087,lng:116.4575},{label:"奥攀攀岩馆",value:"aopan",lat:39.9928,lng:116.3946},{label:"首体攀岩馆",value:"shouti",lat:39.9337,lng:116.3324},{label:"岩舞空间（大悦城店）",value:"yanwu_dayuecheng",lat:39.9127,lng:116.4779}],X=[{value:a.BOULDERING,label:"抱石 🧗‍♀️",icon:"🪨"},{value:a.TOP_ROPE_AUTO_BELAY,label:"上方保护（自动） ⬆️",icon:"🔗"},{value:a.TOP_ROPE_MANUAL_BELAY,label:"上方保护（人工） ⬆️",icon:"🔗"},{value:a.LEAD_CLIMBING,label:"先锋攀登 🚀",icon:"🚀"},{value:a.OUTDOOR,label:"户外攀岩 🏔️",icon:"🏔️"},{value:a.TRAINING,label:"训练 💪",icon:"💪"}],Z=()=>{const l=f(),{user:i,activities:n,setActivities:o}=z(),[c,d]=j.useState({title:"",description:"",types:[a.BOULDERING],grades:[e.V0_V2],slotMax:4,meetMode:s.MEET_AT_ENTRANCE,costMode:t.AA,cost:0,isPrivate:!1,selectedGym:null});return r.jsxs("div",{className:"create-activity-overlay",children:[r.jsx("div",{className:"create-activity-header",children:r.jsxs("div",{className:"header-content",children:[r.jsx("button",{type:"button",onClick:()=>l(-1),className:"close-button","aria-label":"返回",children:r.jsx(Y,{})}),r.jsxs("div",{className:"header-title-section",children:[r.jsxs("div",{className:"title-with-icon",children:[r.jsx("div",{className:"title-icon-wrapper",children:r.jsx(J,{})}),r.jsx("h1",{className:"header-title",children:"创建新活动"})]}),r.jsx("p",{className:"header-subtitle",children:"让我们一起攀岩吧！"})]}),r.jsx("div",{className:"w-10"})," "]})}),r.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),i)if(c.selectedGym)try{const e={title:c.title,description:c.description,types:c.types,grades:c.grades,slotMax:c.slotMax,meetMode:c.meetMode,costMode:c.costMode,cost:c.costMode===t.HOST_TREAT?c.cost:0,isPrivate:c.isPrivate,gymId:c.selectedGym.id,organizerId:i.openid,id:Date.now().toString(),startTime:new Date,endTime:new Date(Date.now()+72e5),status:"OPEN",participants:[],createdAt:new Date,updatedAt:new Date};o([...n,e]),T.success("Activity created successfully!"),l("/activities")}catch(a){T.error("Failed to create activity. Please try again.")}else T.error("Please select a climbing gym");else T.error("Please login to create an activity")},className:"create-activity-form",children:[r.jsxs("div",{className:"form-section",children:[r.jsxs("div",{className:"section-header",children:[r.jsx("div",{className:"section-icon",children:r.jsx(K,{})}),r.jsxs("div",{children:[r.jsx("h3",{className:"section-title",children:"基础信息"}),r.jsx("p",{className:"section-description",children:"让大家了解你的活动"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"title",className:"form-label",children:["活动标题 ",r.jsx("span",{className:"required",children:"*"})]}),r.jsx("input",{type:"text",id:"title",name:"title",value:c.title,onChange:e=>d((a=>({...a,title:e.target.value}))),className:"form-input",placeholder:"例如：周末欢乐抱石局 🧗‍♀️",maxLength:50,required:!0})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"description",className:"form-label",children:"活动描述"}),r.jsx("textarea",{id:"description",name:"description",value:c.description,onChange:e=>d((a=>({...a,description:e.target.value}))),className:"form-textarea",placeholder:"分享更多详情：路线风格、集合点、注意事项等...",rows:3,maxLength:200})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsxs("div",{className:"section-header",children:[r.jsx("div",{className:"section-icon",children:r.jsx(F,{})}),r.jsxs("div",{children:[r.jsx("h3",{className:"section-title",children:"选择岩馆"}),r.jsx("p",{className:"section-description",children:"从官方岩馆列表中选择"})]})]}),r.jsx("div",{className:"form-group",children:r.jsx(m,{selectedGymId:c.selectedGym?.id,onGymSelect:e=>d((a=>({...a,selectedGym:e}))),required:!0,placeholder:"请选择攀岩馆",className:"w-full"})})]}),r.jsxs("div",{className:"form-section",children:[r.jsxs("div",{className:"section-header",children:[r.jsx("div",{className:"section-icon",children:r.jsx(W,{})}),r.jsxs("div",{children:[r.jsx("h3",{className:"section-title",children:"活动类型与难度"}),r.jsx("p",{className:"section-description",children:"选择攀岩类型和难度范围"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{className:"form-label",children:["活动类型 ",r.jsx("span",{className:"required",children:"*"})]}),r.jsx("div",{className:"activity-type-grid",children:X.map((e=>r.jsxs("label",{className:"activity-type-option",children:[r.jsx("input",{type:"checkbox",name:"types",value:e.value,checked:c.types.includes(e.value),onChange:e=>d((a=>({...a,types:[...a.types,e.target.value]}))),className:"activity-type-checkbox"}),r.jsxs("div",{className:"activity-type-content",children:[r.jsx("span",{className:"activity-type-icon",children:e.icon}),r.jsx("span",{className:"activity-type-label",children:e.label})]})]},e.value)))})]}),c.types.length>0&&r.jsxs("div",{className:"form-group",children:[r.jsxs("label",{htmlFor:"grades",className:"form-label",children:["难度范围 ",r.jsx("small",{className:"text-gray-500",children:"(可多选)"})]}),r.jsx("select",{id:"grades",name:"grades",value:c.grades,onChange:e=>d((a=>({...a,grades:[...a.grades,e.target.value]}))),multiple:!0,className:"form-select grade-select",size:Math.min(c.types.length,5),children:Q.map((e=>r.jsx("option",{value:e.value,children:e.label},e.value)))})]})]}),r.jsxs("div",{className:"form-section",children:[r.jsxs("div",{className:"section-header",children:[r.jsx("div",{className:"section-icon",children:r.jsx(H,{})}),r.jsxs("div",{children:[r.jsx("h3",{className:"section-title",children:"活动时间"}),r.jsx("p",{className:"section-description",children:"什么时候开始攀岩？"})]})]}),r.jsxs("div",{className:"datetime-grid",children:[r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"slotMax",className:"form-label",children:"人数上限"}),r.jsxs("div",{className:"number-input-wrapper",children:[r.jsx(q,{}),r.jsx("input",{type:"number",id:"slotMax",name:"slotMax",value:c.slotMax,onChange:e=>d((a=>({...a,slotMax:parseInt(e.target.value,10)||1}))),className:"form-input number-input",min:"1",max:"50",required:!0}),r.jsx("span",{className:"input-suffix",children:"人 (含自己)"})]})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"meetMode",className:"form-label",children:"集合方式"}),r.jsx("select",{id:"meetMode",name:"meetMode",value:c.meetMode,onChange:e=>d((a=>({...a,meetMode:e.target.value}))),className:"form-select",required:!0,children:Object.values(s).map((e=>r.jsx("option",{value:e,children:e===s.MEET_AT_ENTRANCE?"🚪 门口集合":"🏃‍♂️ 先到先攀"},e)))})]}),r.jsxs("div",{className:"form-group",children:[r.jsx("label",{htmlFor:"costMode",className:"form-label",children:"费用方式"}),r.jsx("select",{id:"costMode",name:"costMode",value:c.costMode,onChange:e=>d((a=>({...a,costMode:e.target.value}))),className:"form-select",required:!0,children:Object.values(t).map((e=>r.jsx("option",{value:e,children:e===t.AA?"💰 AA制":e===t.HOST_TREAT?"🎁 发起人请客":"🆓 免费"},e)))})]})]}),r.jsx("div",{className:"form-group",children:r.jsxs("label",{className:"checkbox-label",children:[r.jsx("input",{type:"checkbox",id:"isPrivate",name:"isPrivate",checked:c.isPrivate,onChange:e=>d((a=>({...a,isPrivate:e.target.checked}))),className:"form-checkbox"}),r.jsxs("span",{className:"checkbox-text",children:["🔒 设为私密活动 ",r.jsx("small",{className:"text-gray-500",children:"(仅受邀者可见)"})]})]})})]}),r.jsx("div",{className:"submit-section",children:r.jsx("button",{type:"submit",className:"submit-button",children:r.jsxs("div",{className:"submit-content",children:[r.jsx(J,{}),r.jsx("span",{children:"发布活动"})]})})})]})]})},ee=Object.freeze(Object.defineProperty({__proto__:null,CreateActivity:Z,default:Z},Symbol.toStringTag,{value:"Module"})),ae=N.memo((({activity:e,index:a,onActivityClick:s})=>{const t=j.useCallback((()=>{s(e)}),[e,s]);return r.jsx("div",{className:"activity-item mb-4",style:{animation:`fadeInUp 0.4s ease-out ${Math.min(.1*a,1)}s both`},children:r.jsx(U,{activity:e,onClick:t,showDistance:!0})})}));ae.displayName="MemoizedActivityCard";const se=N.memo((({selectedTypes:e,selectedGrades:a,onClearFilters:s})=>e.length>0||a.length>0?r.jsx("div",{className:"mb-2 p-3 bg-blue-50 rounded-lg border border-blue-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"text-sm text-blue-700",children:[r.jsx("span",{children:"已应用筛选: "}),e.length>0&&r.jsxs("span",{className:"font-medium",children:[e.length," 种类型"]}),e.length>0&&a.length>0&&r.jsx("span",{children:", "}),a.length>0&&r.jsxs("span",{className:"font-medium",children:[a.length," 种难度"]})]}),r.jsx("button",{onClick:s,className:"text-blue-600 hover:text-blue-800 text-sm font-medium underline",children:"清除筛选"})]})}):null));se.displayName="FilterSummary";const te=N.memo((()=>{const e=f(),{activities:a,isLoadingActivities:s}=u(),{fetchActivities:t,refreshActivities:l}=x(),{selectedTypes:i,selectedGrades:n}=h(),{setSelectedTypes:o,setSelectedGrades:c,resetFilters:d}=g(),m=j.useMemo((()=>({activitiesCount:a.length,isLoading:s})),[a.length,s]);j.useEffect((()=>{0!==a.length||s||t().catch((e=>{C("获取活动列表失败，请检查网络连接")}))}),[m,a.length,s,t]);const[y,N]=j.useState(10),[w,k]=j.useState(!1),[A,L]=j.useState(!1),[$,T]=j.useState([]),[_,S]=j.useState(!1),O=j.useCallback((a=>{e(`/activity/${a.id}`)}),[e]),D=j.useCallback((a=>{e(`/activity/${a.id}`)}),[e]),E=j.useCallback((()=>{e("/create-activity")}),[e]),P=j.useMemo((()=>{let e;return a=>{clearTimeout(e),e=setTimeout((()=>{T(a),S(a.length>0)}),150)}}),[]),I=j.useCallback((e=>{P(e)}),[P]),B=j.useMemo((()=>{performance.now();let e=_?$:a;i.length>0&&(e=e.filter((e=>e.types.some((e=>i.includes(e)))))),n.length>0&&(e=e.filter((e=>e.grades.some((e=>n.includes(e))))));const s=[...e].sort(((e,a)=>new Date(e.datetime).getTime()-new Date(a.datetime).getTime()));return performance.now(),s}),[a,$,_,i,n]),R=j.useMemo((()=>({currentActivities:B.slice(0,y),hasMore:y<B.length,totalCount:B.length})),[B,y]),G=j.useCallback((async()=>{!A&&R.hasMore&&(L(!0),await new Promise((e=>setTimeout(e,300))),N((e=>Math.min(e+10,B.length))),L(!1))}),[A,R.hasMore,B.length]),U=j.useCallback((async()=>{if(!w){k(!0);try{await l(),N(10),S(!1),T([]),M("活动列表已更新！")}catch(e){C("刷新失败，请重试")}finally{k(!1)}}}),[w,l]),V=j.useMemo((()=>({types:i,grades:n})),[i,n]),z=j.useCallback((e=>{o(e.types),c(e.grades),N(10)}),[o,c]),Y=j.useCallback((()=>{d(),N(10)}),[d]),F=j.useMemo((()=>i.length>0||n.length>0),[i.length,n.length]),H=j.useMemo((()=>0===R.currentActivities.length?r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:"🧗‍♀️"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:F?"没有符合条件的活动":"暂无活动"}),r.jsx("p",{className:"text-gray-600 mb-6",children:F?"尝试调整筛选条件或清除筛选":"成为第一个创建活动的人！"}),!F&&r.jsx("button",{onClick:E,className:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg font-medium transition-colors",children:"创建活动"})]}):r.jsx(p,{hasMore:R.hasMore,loadMore:G,loading:A,children:r.jsx("div",{className:"space-y-4",children:R.currentActivities.map(((e,a)=>r.jsx(ae,{activity:e,index:a,onActivityClick:O},e.id)))})})),[R.currentActivities,R.hasMore,F,A,G,O,E]);return r.jsx(b,{onRefresh:U,isRefreshing:w,children:r.jsxs("div",{className:"min-h-screen p-6 pb-20",style:{background:"linear-gradient(180deg, rgba(248, 250, 252, 0.9) 0%, rgba(241, 245, 249, 0.8) 100%)"},children:[r.jsx("div",{className:"mb-3",children:r.jsx(v,{activities:a,onSearchResults:I,onActivityClick:D,filters:V,onFiltersChange:z,placeholder:"🔍 实时搜索活动名称或地点...",debounceMs:300,maxResults:15})}),r.jsx(se,{selectedTypes:i,selectedGrades:n,onClearFilters:Y}),H,s&&!w&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-20 flex items-center justify-center z-50",children:r.jsx("div",{className:"bg-white rounded-lg p-6 shadow-lg",children:r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-2 border-blue-500 border-t-transparent"}),r.jsx("span",{className:"text-gray-700",children:"加载中..."})]})})})]})})})),re=Object.freeze(Object.defineProperty({__proto__:null,default:te},Symbol.toStringTag,{value:"Module"})),le=()=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-6 h-6",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})}),ie=({className:e="w-5 h-5"})=>r.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:`text-primary-600 ${e}`,children:[r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6l4 2"}),r.jsx("circle",{cx:"12",cy:"12",r:"10"})]}),ne=({className:e="w-5 h-5"})=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:`text-secondary-600 ${e}`,children:r.jsx("path",{fillRule:"evenodd",d:"M11.54 22.351l.07.04.028.016a.76.76 0 00.723 0l.028-.015.071-.041a16.975 16.975 0 001.144-.742 19.58 19.58 0 002.683-2.282c1.944-1.99 3.963-4.98 3.963-8.827a8.25 8.25 0 00-16.5 0c0 3.846 2.02 6.837 3.963 8.827a19.58 19.58 0 002.682 2.282 16.92 16.92 0 001.145.742zM12 13.5a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})}),oe=({className:e="w-5 h-5"})=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:`text-accent-600 ${e}`,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})}),ce=({className:e="w-5 h-5"})=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:`text-neutral-600 ${e}`,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.625 12a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H8.25m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H12m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 01-2.555-.337A5.972 5.972 0 015.41 20.97a5.969 5.969 0 01-.474-.065 4.48 4.48 0 00.978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25z"})}),de=[{activityId:"1",userId:"user2",joinTime:new Date,user:{openid:"user2",nickname:"Alice",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Alice",level:3,gearTags:[],createdAt:new Date}},{activityId:"1",userId:"user3",joinTime:new Date,user:{openid:"user3",nickname:"Bob",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Bob",level:2,gearTags:[],createdAt:new Date}}],me=[{id:"1",activityId:"1",userId:"user2",content:"期待！我会准时到的",timestamp:new Date,user:{openid:"user2",nickname:"Alice",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Alice",level:3,gearTags:[],createdAt:new Date}}],ue=({type:e="default",children:a,className:s=""})=>r.jsx("span",{className:`inline-flex items-center px-3 py-1 text-xs font-semibold rounded-xl backdrop-blur-sm ${s}`,style:(()=>{switch(e){case"primary":return{background:`linear-gradient(135deg, ${A.primary[100]} 0%, ${A.primary[200]} 100%)`,color:A.primary[700],border:`1px solid ${A.primary[300]}`};case"success":return{background:`linear-gradient(135deg, ${A.success.subtle} 0%, ${A.success.soft} 100%)`,color:A.success.primary,border:`1px solid ${A.success.primary}`};case"warning":return{background:`linear-gradient(135deg, ${A.warning.subtle} 0%, ${A.warning.soft} 100%)`,color:A.warning.primary,border:`1px solid ${A.warning.primary}`};case"error":return{background:`linear-gradient(135deg, ${A.error.subtle} 0%, ${A.error.soft} 100%)`,color:A.error.primary,border:`1px solid ${A.error.primary}`};case"info":return{background:`linear-gradient(135deg, ${A.info.subtle} 0%, ${A.info.soft} 100%)`,color:A.info.primary,border:`1px solid ${A.info.primary}`};default:return{background:`linear-gradient(135deg, ${A.neutral[100]} 0%, ${A.neutral[200]} 100%)`,color:A.neutral[700],border:`1px solid ${A.neutral[300]}`}}})(),children:a}),xe=({description:e,icon:a="🧗‍♀️",className:s=""})=>r.jsxs("div",{className:`flex flex-col items-center justify-center text-center p-12 rounded-2xl backdrop-blur-sm ${s}`,style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.8) 0%, rgba(255, 255, 255, 0.6) 100%)",boxShadow:L.card},children:[r.jsx("div",{className:"text-6xl mb-4",children:a}),r.jsx("p",{className:"text-lg font-semibold",style:{color:A.neutral[600]},children:e})]}),he=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const{id:e}=w(),a=f(),{activities:i}=u(),{setCurrentActivity:o}=x(),{user:c}=y(),[d,m]=j.useState(void 0),[h,g]=j.useState([]),[p,b]=j.useState([]),[v,N]=j.useState(!1),[k,$]=j.useState(!1);j.useEffect((()=>{const a=i.find((a=>a.id===e));a?(m(a),o(a),"1"===a.id?(g(de),b(me),N(de.some((e=>e.userId===c?.openid)))):(g([]),b([]),N(a.participantIds?.includes(c?.openid||"")||!1))):(m(void 0),o(null))}),[e,i,o,c]);const T=()=>{a(-1)},_=e=>{a(`/profile/${e}`)};if(!d)return r.jsxs("div",{className:"min-h-screen p-6",style:{background:"linear-gradient(180deg, rgba(248, 250, 252, 0.9) 0%, rgba(241, 245, 249, 0.8) 100%)"},children:[r.jsx("div",{className:"bg-white shadow-sm sticky top-0 z-10 mb-6 rounded-2xl backdrop-blur-lg",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.85) 100%)",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:L.medium},children:r.jsx("div",{className:"px-6 py-4",children:r.jsxs("div",{className:"relative flex items-center justify-center",children:[r.jsx("button",{onClick:T,className:"absolute left-0 p-2 rounded-xl transition-all duration-200 hover:scale-110 active:scale-95",style:{background:`linear-gradient(135deg, ${A.neutral[100]} 0%, ${A.neutral[200]} 100%)`,color:A.primary[600]},"aria-label":"Go back",children:r.jsx(le,{})}),r.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r bg-clip-text text-transparent",style:{backgroundImage:`linear-gradient(135deg, ${A.primary[600]} 0%, ${A.secondary[600]} 100%)`},children:"🧗‍♀️ 活动详情"})]})})}),r.jsx(xe,{description:"活动不存在",icon:"🤔"})]});const S=c?.openid===d.hostId,O=h.length>=d.slotMax,D=l(d.datetime).isBefore(l()),E=!(S||v||O||D),P=v&&!S&&!D;return r.jsxs("div",{className:"min-h-screen pb-24 p-6",style:{background:"linear-gradient(180deg, rgba(248, 250, 252, 0.9) 0%, rgba(241, 245, 249, 0.8) 100%)"},children:[r.jsx("div",{className:"bg-white shadow-sm sticky top-0 z-10 mb-6 rounded-2xl backdrop-blur-lg",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.85) 100%)",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:L.medium},children:r.jsx("div",{className:"px-6 py-4",children:r.jsxs("div",{className:"relative flex items-center justify-center",children:[r.jsx("button",{onClick:T,className:"absolute left-0 p-2 rounded-xl transition-all duration-200 hover:scale-110 active:scale-95",style:{background:`linear-gradient(135deg, ${A.neutral[100]} 0%, ${A.neutral[200]} 100%)`,color:A.primary[600]},"aria-label":"Go back",children:r.jsx(le,{})}),r.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r bg-clip-text text-transparent",style:{backgroundImage:`linear-gradient(135deg, ${A.primary[600]} 0%, ${A.secondary[600]} 100%)`},children:"🧗‍♀️ 活动详情"})]})})}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"p-6 rounded-2xl backdrop-blur-sm",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%)",boxShadow:L.card,border:"1px solid rgba(255, 255, 255, 0.3)"},children:[r.jsx("h2",{className:"text-2xl font-bold mb-4",style:{color:A.neutral[800]},children:d.title}),r.jsxs("div",{className:"space-y-3 mb-6",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 rounded-xl",style:{background:`linear-gradient(135deg, ${A.primary[100]} 0%, ${A.primary[200]} 100%)`},children:r.jsx(ie,{className:"w-5 h-5"})}),r.jsx("span",{className:"font-medium",style:{color:A.neutral[700]},children:l(d.datetime).format("MM月DD日 HH:mm")})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 rounded-xl",style:{background:`linear-gradient(135deg, ${A.secondary[100]} 0%, ${A.secondary[200]} 100%)`},children:r.jsx(ne,{className:"w-5 h-5"})}),r.jsx("span",{className:"font-medium",style:{color:A.neutral[700]},children:d.locationText})]}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"p-2 rounded-xl",style:{background:`linear-gradient(135deg, ${A.accent[100]} 0%, ${A.accent[200]} 100%)`},children:r.jsx(oe,{className:"w-5 h-5"})}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("span",{className:"font-medium",style:{color:A.neutral[700]},children:[h.length,"/",d.slotMax,"人"]}),O&&r.jsx(ue,{type:"warning",children:"已满员"})]})]})]}),r.jsxs("div",{className:"flex flex-wrap gap-3",children:[r.jsx(ue,{type:"primary",children:d.meetMode===s.MEET_AT_ENTRANCE?"🚪 门口集合":"🏃‍♀️ 先到先攀"}),r.jsx(ue,{type:"success",children:d.costMode===t.FREE?"🆓 免费":d.costMode===t.AA?"💰 AA":"🎁 我请客"}),d.isPrivate&&r.jsx(ue,{type:"warning",children:"🔒 私密活动"})]})]}),r.jsxs("div",{className:"p-6 rounded-2xl backdrop-blur-sm cursor-pointer transition-all duration-300 hover:scale-[1.02]",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%)",boxShadow:L.card,border:"1px solid rgba(255, 255, 255, 0.3)"},onClick:()=>_(d.hostId),children:[r.jsx("h3",{className:"text-lg font-bold mb-4",style:{color:A.neutral[700]},children:"👨‍💼 发起人"}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx(n,{avatar:d.host?.avatar,nickname:d.host?.nickname||"发起人",level:d.host?.level,size:56}),r.jsxs("div",{children:[r.jsx("div",{className:"text-lg font-bold",style:{color:A.neutral[800]},children:d.host?.nickname||"发起人"}),r.jsxs("div",{className:"text-sm font-medium",style:{color:A.neutral[500]},children:["Lv.",d.host?.level||1," 攀岩者"]})]})]})]}),r.jsxs("div",{className:"p-6 rounded-2xl backdrop-blur-sm",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%)",boxShadow:L.card,border:"1px solid rgba(255, 255, 255, 0.3)"},children:[r.jsxs("h3",{className:"text-lg font-bold mb-4",style:{color:A.neutral[700]},children:["👥 参与者 (",h.length,")"]}),h.length>0?r.jsx("div",{className:"flex flex-wrap gap-4",children:h.map((e=>r.jsxs("div",{className:"flex flex-col items-center cursor-pointer transform hover:scale-105 transition-all duration-200 p-3 rounded-xl",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.6) 0%, rgba(255, 255, 255, 0.4) 100%)"},onClick:()=>_(e.userId),children:[r.jsx(n,{avatar:e.user?.avatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${e.userId}`,nickname:e.user?.nickname||e.userId,size:48}),r.jsx("span",{className:"text-xs mt-2 font-medium text-center max-w-16 truncate",style:{color:A.neutral[600]},children:e.user?.nickname||e.userId})]},e.userId)))}):r.jsx(xe,{description:"暂无其他参与者",icon:"👥",className:"py-8"})]}),r.jsxs("div",{className:"p-6 rounded-2xl backdrop-blur-sm cursor-pointer transition-all duration-300 hover:scale-[1.02] hover:shadow-lg",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%)",boxShadow:L.card,border:"1px solid rgba(255, 255, 255, 0.3)"},onClick:()=>{a(`/comment-board/${e}`)},children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsxs("h3",{className:"text-lg font-bold",style:{color:A.neutral[700]},children:["💬 留言板 (",p.length,")"]}),r.jsx("div",{className:"p-2 rounded-xl",style:{background:`linear-gradient(135deg, ${A.neutral[100]} 0%, ${A.neutral[200]} 100%)`},children:r.jsx(ce,{className:"w-5 h-5"})})]}),p.length>0&&d&&d.comments&&d.comments.length>0?r.jsxs("div",{className:"text-sm",style:{color:A.neutral[600]},children:[r.jsxs("strong",{style:{color:A.neutral[800]},children:[d.comments[0].user?.nickname||"User",":"]})," ",d.comments[0].content,d.comments.length>1&&r.jsx("span",{className:"text-xs ml-2",style:{color:A.neutral[400]},children:"...和更多"})]}):p.length>0?r.jsxs("div",{className:"text-sm",style:{color:A.neutral[600]},children:[r.jsxs("strong",{style:{color:A.neutral[800]},children:[p[0].user?.nickname||"User",":"]})," ",p[0].content,p.length>1&&r.jsx("span",{className:"text-xs ml-2",style:{color:A.neutral[400]},children:"...和更多"})]}):r.jsx("p",{className:"text-sm",style:{color:A.neutral[500]},children:"暂无留言，点击查看或添加。"})]})]}),r.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-6 z-10 max-w-md mx-auto backdrop-blur-lg",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.85) 100%)",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:`${L.large}, inset 0 1px 0 rgba(255, 255, 255, 0.8)`},children:S?r.jsx("button",{className:"w-full py-4 px-6 rounded-2xl font-bold text-lg transition-all duration-300",style:{background:`linear-gradient(135deg, ${A.neutral[300]} 0%, ${A.neutral[400]} 100%)`,color:A.neutral[600]},disabled:!0,children:"👑 你是发起人"}):D?r.jsx("button",{className:"w-full py-4 px-6 rounded-2xl font-bold text-lg transition-all duration-300",style:{background:`linear-gradient(135deg, ${A.neutral[300]} 0%, ${A.neutral[400]} 100%)`,color:A.neutral[600]},disabled:!0,children:"⏰ 活动已开始"}):E?r.jsx("button",{className:"w-full py-4 px-6 rounded-2xl font-bold text-lg text-white transition-all duration-300 hover:scale-[1.02] active:scale-95 disabled:opacity-50",style:{background:k?`linear-gradient(135deg, ${A.neutral[400]} 0%, ${A.neutral[500]} 100%)`:`linear-gradient(135deg, ${A.primary[500]} 0%, ${A.secondary[600]} 100%)`,boxShadow:k?L.soft:L.medium},disabled:k,onClick:async()=>{if(c&&d){$(!0);try{await new Promise((e=>setTimeout(e,1e3)));const e={activityId:d.id,userId:c.openid,joinTime:new Date,user:c};g([...h,e]),N(!0),M("报名成功！")}catch(e){C("报名失败，请重试")}finally{$(!1)}}},children:k?"⏳ 处理中...":"🚀 立即报名"}):P?r.jsx("button",{className:"w-full py-4 px-6 rounded-2xl font-bold text-lg text-white transition-all duration-300 hover:scale-[1.02] active:scale-95 disabled:opacity-50",style:{background:k?`linear-gradient(135deg, ${A.neutral[300]} 0%, ${A.neutral[400]} 100%)`:`linear-gradient(135deg, ${A.error.primary} 0%, ${A.error.secondary} 100%)`,boxShadow:k?L.soft:L.medium},disabled:k,onClick:async()=>{if(c&&d&&window.confirm("确定要取消报名吗？")){$(!0);try{await new Promise((e=>setTimeout(e,1e3))),g(h.filter((e=>e.userId!==c.openid))),N(!1),M("已取消报名")}catch(e){C("取消失败，请重试")}finally{$(!1)}}},children:k?"⏳ 处理中...":"❌ 取消报名"}):O?r.jsx("button",{className:"w-full py-4 px-6 rounded-2xl font-bold text-lg transition-all duration-300",style:{background:`linear-gradient(135deg, ${A.warning.soft} 0%, ${A.warning.subtle} 100%)`,color:A.warning.primary},disabled:!0,children:"🈵 已满员"}):v&&!S?r.jsx("button",{className:"w-full py-4 px-6 rounded-2xl font-bold text-lg text-white transition-all duration-300",style:{background:`linear-gradient(135deg, ${A.success.primary} 0%, ${A.success.secondary} 100%)`,boxShadow:L.soft},disabled:!0,children:"✅ 已报名"}):r.jsx("button",{className:"w-full py-4 px-6 rounded-2xl font-bold text-lg transition-all duration-300",style:{background:`linear-gradient(135deg, ${A.neutral[300]} 0%, ${A.neutral[400]} 100%)`,color:A.neutral[600]},disabled:!0,children:"🚫 暂不可操作"})})]})}},Symbol.toStringTag,{value:"Module"}));export{U as A,ee as C,re as a,he as b,z as u};
