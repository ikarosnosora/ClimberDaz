import{j as e,U as a,d as s,r as t}from"./auth-features-B9i09fKj.js";import{b as r,u as l,r as i}from"./router-DIp0qzM7.js";import{u as n}from"./activity-features-BeCPKsHJ.js";import{d,s as o,c,g as m}from"./utils-C8L9ZeeV.js";import"./react-core-DJd1KkWy.js";import"./state-Dl9MXZu6.js";import"./datetime-C5xEksKA.js";import"./http-client-CnGGTTUv.js";import"./notifications-DK5Y3Ipx.js";import"./storage-BRXjPTYW.js";s.extend(t),s.locale("zh-cn");const u=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-6 h-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})}),x=()=>e.jsx("div",{className:"animate-pulse p-4 rounded-2xl backdrop-blur-sm",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.6) 0%, rgba(255, 255, 255, 0.4) 100%)"},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full",style:{background:`linear-gradient(135deg, ${c.neutral[200]} 0%, ${c.neutral[300]} 100%)`}}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 rounded",style:{background:`linear-gradient(135deg, ${c.neutral[200]} 0%, ${c.neutral[300]} 100%)`,width:"60%"}}),e.jsx("div",{className:"h-3 rounded",style:{background:`linear-gradient(135deg, ${c.neutral[200]} 0%, ${c.neutral[300]} 100%)`,width:"80%"}})]})]})}),g=({description:a})=>e.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-12 rounded-2xl backdrop-blur-sm mx-6",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.8) 0%, rgba(255, 255, 255, 0.6) 100%)",boxShadow:o.card},children:[e.jsx("div",{className:"text-6xl mb-4",children:"💬"}),e.jsx("p",{className:"text-lg font-semibold",style:{color:c.neutral[600]},children:a})]}),p=({comment:t,isHost:r,onUserClick:l})=>e.jsx("div",{className:"p-4 rounded-2xl backdrop-blur-sm mb-4 transition-all duration-300 hover:scale-[1.01]",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%)",boxShadow:o.card,border:"1px solid rgba(255, 255, 255, 0.3)"},children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{onClick:l,className:"cursor-pointer transform hover:scale-110 transition-all duration-200",children:e.jsx(a,{avatar:t.user?.avatar,nickname:t.user?.nickname||"用户",level:t.user?.level,size:44})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-bold text-sm",style:{color:c.neutral[800]},children:t.user?.nickname||"用户"}),r&&e.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-xl",style:{background:`linear-gradient(135deg, ${c.primary[100]} 0%, ${c.primary[200]} 100%)`,color:c.primary[700]},children:"👑 发起人"})]}),e.jsx("span",{className:"text-xs font-medium",style:{color:c.neutral[500]},children:s(t.timestamp).fromNow()})]}),e.jsx("div",{className:"text-sm font-medium leading-relaxed break-words whitespace-pre-wrap",style:{color:c.neutral[700]},children:t.content})]})]})}),b=({placeholder:a,value:s,onChange:t,maxLength:r,disabled:l})=>e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{placeholder:a,value:s,onChange:e=>t(e.target.value),maxLength:r,disabled:l,rows:2,className:"w-full px-4 py-3 text-sm font-medium rounded-2xl transition-all duration-300 ease-smooth focus:outline-none focus:ring-4 backdrop-blur-sm resize-none",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%)",border:`2px solid ${c.neutral[200]}`,backdropFilter:"blur(10px)",boxShadow:o.soft},onFocus:e=>{e.target.style.borderColor=c.primary[400],e.target.style.boxShadow=`0 0 0 4px ${c.primary[100]}`},onBlur:e=>{e.target.style.borderColor=c.neutral[200],e.target.style.boxShadow=o.soft}}),e.jsxs("div",{className:"absolute bottom-2 right-3 text-xs font-medium",style:{color:c.neutral[400]},children:[s.length,"/",r]})]}),h=[{id:"1",activityId:"1",userId:"user2",content:"期待！我会准时到的，大家记得带好装备哦～ 🧗‍♀️",timestamp:new Date(Date.now()-36e5),user:{openid:"user2",nickname:"Alice",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Alice",level:3,gearTags:[],createdAt:new Date}},{id:"2",activityId:"1",userId:"user3",content:"请问新手可以参加吗？我只爬过V2的线路 🤔",timestamp:new Date(Date.now()-72e5),user:{openid:"user3",nickname:"Bob",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Bob",level:1,gearTags:[],createdAt:new Date}},{id:"3",activityId:"1",userId:"user1",content:"当然可以！我们会互相帮助的，新手也欢迎 🏔️",timestamp:new Date(Date.now()-6e6),user:{openid:"user1",nickname:"发起人",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Host",level:5,gearTags:[],createdAt:new Date}}],v=()=>{const{id:a}=r(),s=l(),{user:t,currentActivity:v}=n(),[j,y]=i.useState([]),[f,w]=i.useState(""),[k,N]=i.useState(!1),[$,C]=i.useState(!1),I=i.useCallback((async()=>{N(!0);try{await new Promise((e=>setTimeout(e,500)));const e=h.filter((e=>e.activityId===a));y(e)}catch(e){d("加载评论失败")}finally{N(!1)}}),[a]);return i.useEffect((()=>{I()}),[a,I]),e.jsxs("div",{className:"min-h-screen flex flex-col",style:{background:"linear-gradient(180deg, rgba(248, 250, 252, 0.9) 0%, rgba(241, 245, 249, 0.8) 100%)"},children:[e.jsx("div",{className:"sticky top-0 z-10 mb-6 backdrop-blur-lg",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.85) 100%)",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:o.medium},children:e.jsx("div",{className:"px-6 py-4",children:e.jsxs("div",{className:"relative flex items-center justify-center",children:[e.jsx("button",{onClick:()=>{s(-1)},className:"absolute left-0 p-2 rounded-xl transition-all duration-200 hover:scale-110 active:scale-95",style:{background:`linear-gradient(135deg, ${c.neutral[100]} 0%, ${c.neutral[200]} 100%)`,color:c.primary[600]},children:e.jsx(u,{})}),e.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r bg-clip-text text-transparent",style:{backgroundImage:`linear-gradient(135deg, ${c.primary[600]} 0%, ${c.secondary[600]} 100%)`},children:"💬 留言板"})]})})}),e.jsx("div",{className:"flex-1 overflow-y-auto pb-32 px-6",children:k?e.jsx("div",{className:"space-y-4",children:[1,2,3].map((a=>e.jsx(x,{},a)))}):0===j.length?e.jsx("div",{className:"pt-10",children:e.jsx(g,{description:"暂无留言，快来抢沙发！"})}):e.jsx("div",{children:j.map((a=>{return e.jsx(p,{comment:a,isHost:(t=a.userId,t===v?.hostId),onUserClick:()=>(e=>{s(`/profile/${e}`)})(a.userId)},a.id);var t}))})}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-6 z-40 backdrop-blur-lg",style:{background:"linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.85) 100%)",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:`${o.large}, inset 0 1px 0 rgba(255, 255, 255, 0.8)`},children:e.jsxs("div",{className:"flex items-end gap-3 max-w-md mx-auto",children:[e.jsx("div",{className:"flex-1",children:e.jsx(b,{placeholder:"💭 说点什么...",value:f,onChange:w,maxLength:100,disabled:$})}),e.jsxs("button",{onClick:async()=>{if(f.trim()){if(!t)return d("请先登录"),void s("/login");if(f.length>100)d("评论不能超过100字");else{C(!0);try{await new Promise((e=>setTimeout(e,1e3)));const e={id:`comment_${Date.now()}`,activityId:a,userId:t.openid,content:f.trim(),timestamp:new Date,user:t};y([e,...j]),w(""),m("发送成功")}catch(e){d("发送失败，请重试")}finally{C(!1)}}}else d("请输入评论内容")},disabled:!f.trim()||$,className:"px-6 py-3 text-sm font-bold text-white rounded-2xl transition-all duration-300 ease-smooth hover:scale-[1.02] active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",style:{background:!f.trim()||$?`linear-gradient(135deg, ${c.neutral[400]} 0%, ${c.neutral[500]} 100%)`:`linear-gradient(135deg, ${c.primary[500]} 0%, ${c.secondary[600]} 100%)`,boxShadow:!f.trim()||$?o.soft:o.medium},children:[$&&e.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),$?"发送中...":"🚀 发送"]})]})})]})};export{v as default};
