import{t as A,u as O,v as M,r as b,R as w,j as e,U as T,z as $,q as p,k as U,S as _,p as f,E as N}from"./index-JcghwglV.js";const v={nickname:"Alice",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Alice"},B=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})}),D=({title:i,onBack:a})=>e.jsxs("div",{className:"bg-white shadow-sm flex items-center p-4 sticky top-0 z-10",children:[a&&e.jsx("button",{onClick:a,className:"mr-2 text-gray-600 hover:text-gray-800",children:e.jsx(B,{})}),e.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:i})]}),I=({label:i,name:a,helpText:d,showCount:m,maxLength:n,value:r,error:o,...l})=>{var c;return e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:a,className:"block text-sm font-medium text-gray-700 mb-1",children:i}),d&&e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:d}),e.jsx("textarea",{id:a,name:a,value:r,maxLength:n,...l,className:`block w-full px-3 py-2 border ${o?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm bg-gray-50`}),e.jsxs("div",{className:"flex justify-between items-center",children:[o&&e.jsx("p",{className:"mt-1 text-xs text-red-500 flex-grow",children:o}),m&&n&&e.jsxs("p",{className:`mt-1 text-xs ${o?"text-red-500":"text-gray-500"} ml-auto`,children:[((c=String(r))==null?void 0:c.length)||0," / ",n]})]})]})},G=()=>{const{activityId:i}=A(),a=O(),{user:d}=M(),[m,n]=b.useState(""),[r,o]=b.useState(null),[l,c]=b.useState(!1),[g,y]=b.useState({}),S=()=>a(-1),E=()=>{const t={};return r||(t.status="è¯·é€‰æ‹©ä¸€ä¸ªè¯„ä»·çŠ¶æ€"),m.length>f.COMMENT.MAX_LENGTH&&(t.comment=`è¯„ä»·å†…å®¹ä¸èƒ½è¶…è¿‡${f.COMMENT.MAX_LENGTH}å­—`),y(t),Object.keys(t).length===0},j=async t=>{if(t.preventDefault(),!E()){r||$("è¯·é€‰æ‹©ä¸€ä¸ªè¯„ä»·çŠ¶æ€");return}if(!d){p(N.UNAUTHORIZED),a("/login");return}c(!0);try{await new Promise(s=>setTimeout(s,1500)),U(_.REVIEW_SUBMITTED),a(`/activity/${i}`)}catch(s){p(N.SERVER_ERROR),console.error("Review submission error:",s)}finally{c(!1)}},k=async()=>{window.confirm("ç¡®å®šè¦è·³è¿‡è¯„ä»·å—ï¼Ÿè·³è¿‡åå°†æ— æ³•å†æ¬¡è¯„ä»·ã€‚")&&a(-1)},C=[{label:"ğŸ‘ è¡¨ç°å¾ˆå¥½ (Good)",value:w.GOOD,color:"green"},{label:"ğŸ‘ æœ‰å¾…æ”¹è¿› (Bad)",value:w.BAD,color:"red"},{label:"ğŸ˜• æœªåˆ°åœº (No-Show)",value:w.NO_SHOW,color:"yellow"}];return e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsx(D,{title:"äº’è¯„å‚ä¸è€…",onBack:S}),e.jsxs("div",{className:"p-3",children:[e.jsx("div",{className:"mb-5 p-4 bg-white rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(T,{avatar:v.avatar,nickname:v.nickname,size:50}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-0.5",children:v.nickname}),e.jsx("p",{className:"text-sm text-gray-600",children:"å¯¹æœ¬æ¬¡æ´»åŠ¨çš„å‚ä¸æƒ…å†µåšå‡ºè¯„ä»·"})]})]})}),e.jsxs("div",{className:"mb-5 p-5 bg-white rounded-lg shadow",children:[e.jsx("p",{className:"text-base font-medium text-center mb-4 text-gray-700",children:"é€‰æ‹©è¯„ä»·:"}),g.status&&e.jsx("p",{className:"text-xs text-red-500 text-center mb-2",children:g.status}),e.jsx("div",{className:"flex flex-col space-y-3",children:C.map(t=>{const s=r===t.value;let x=s?`bg-${t.color}-500`:"bg-white",u=s?"text-white":`text-${t.color}-600`,h=`border-${t.color}-500`;return t.color==="yellow"&&(x=s?"bg-yellow-400":"bg-white",u=s?"text-yellow-800":"text-yellow-600",h="border-yellow-500"),t.color==="green"&&(x=s?"bg-green-500":"bg-white",u=s?"text-white":"text-green-600",h="border-green-500"),t.color==="red"&&(x=s?"bg-red-500":"bg-white",u=s?"text-white":"text-red-600",h="border-red-500"),e.jsx("button",{type:"button",onClick:()=>{o(t.value),y(R=>({...R,status:void 0}))},className:`w-full py-3 px-4 border rounded-md text-sm font-medium shadow-sm transition-colors duration-150 ease-in-out ${h} ${x} ${u} hover:opacity-90 disabled:opacity-50`,children:t.label},t.value)})})]}),e.jsx("form",{onSubmit:j,className:"mb-5 p-5 bg-white rounded-lg shadow",children:e.jsx(I,{label:"è¡¥å……è¯´æ˜ (é€‰å¡«)",name:"comment",placeholder:"ä½ çš„è¯„ä»·å†…å®¹å¯¹å…¶ä»–å²©å‹å¾ˆæœ‰å¸®åŠ© (æœ€å¤š80å­—)",rows:3,maxLength:80,showCount:!0,value:m,onChange:t=>n(t.target.value),helpText:"åˆ†äº«æ›´å¤šç»†èŠ‚ï¼Œä¾‹å¦‚å®ˆæ—¶ã€æŠ€æœ¯ã€æ°›å›´ã€å®‰å…¨ç­‰æ–¹é¢çš„æƒ…å†µã€‚",error:g.comment})}),e.jsxs("div",{className:"mt-5 space-y-3",children:[e.jsxs("button",{type:"submit",onClick:j,disabled:l||!r,className:"w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 text-white text-base font-semibold rounded-md shadow-sm disabled:opacity-60 disabled:cursor-not-allowed transition-colors duration-150 ease-in-out flex items-center justify-center",children:[l&&e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),l?"æäº¤ä¸­...":"æäº¤è¯„ä»·"]}),e.jsx("button",{type:"button",onClick:k,disabled:l,className:"w-full py-3 px-4 border border-gray-300 hover:bg-gray-100 text-gray-700 text-base font-semibold rounded-md shadow-sm disabled:opacity-60 disabled:cursor-not-allowed transition-colors duration-150 ease-in-out",children:"ä»¥åå†è¯´ (è·³è¿‡)"})]}),e.jsxs("div",{className:"mt-5 p-4 bg-white rounded-lg shadow text-center text-xs text-gray-600",children:[e.jsx("p",{children:"ğŸ’¡ è¯„ä»·æäº¤åä¸å¯ä¿®æ”¹ã€‚"}),e.jsx("p",{children:"ğŸ”’ æ‚¨çš„è¯„ä»·å°†å¸®åŠ©æˆ‘ä»¬ç»´æŠ¤å‹å¥½çš„ç¤¾åŒºç¯å¢ƒã€‚"})]})]})]})};export{G as default};
